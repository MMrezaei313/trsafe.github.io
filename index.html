<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mousa Trading - Ø³ÛŒØ³ØªÙ… Ø¢Ù†Ù„Ø§ÛŒÙ† Ù¾ÛŒØ´Ø±ÙØªÙ‡</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: Tahoma, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 100%;
            margin: 0 auto;
        }
        
        .login-box {
            max-width: 100%;
            margin: 20px auto;
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .login-box h2 {
            text-align: center;
            margin-bottom: 15px;
            color: #1e3a8a;
            font-size: 1.4rem;
        }
        
        .form-group {
            margin-bottom: 12px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        
        .form-control {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
        }
        
        .btn {
            width: 100%;
            padding: 14px;
            background: #3b82f6;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .btn:hover {
            background: #2563eb;
        }
        
        .main-app {
            display: none;
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .app-header {
            background: #1f2937;
            color: white;
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .app-header h2 {
            font-size: 1.2rem;
            margin-bottom: 5px;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .menu-toggle {
            display: none;
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .market-ticker {
            background: #374151;
            padding: 8px;
            overflow: hidden;
            font-size: 0.85rem;
        }
        
        .ticker-content {
            display: flex;
            animation: ticker 30s linear infinite;
        }
        
        .ticker-item {
            margin: 0 15px;
            white-space: nowrap;
        }
        
        @keyframes ticker {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr;
            min-height: 80vh;
        }
        
        .sidebar {
            background: #1f2937;
            color: white;
            padding: 15px;
            display: none;
        }
        
        .sidebar.active {
            display: block;
        }
        
        .main-content {
            padding: 15px;
            overflow-y: auto;
        }
        
        .menu-item {
            padding: 12px;
            margin: 5px 0;
            cursor: pointer;
            border-radius: 5px;
            transition: background 0.3s;
            font-size: 0.95rem;
        }
        
        .menu-item:hover, .menu-item.active {
            background: #374151;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .price-card {
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
            border: 2px solid #e5e7eb;
            text-align: center;
        }
        
        .current-price {
            font-size: 1.5rem;
            font-weight: bold;
            color: #3b82f6;
            margin: 8px 0;
        }
        
        .price-change {
            font-size: 0.9rem;
            padding: 4px 8px;
            border-radius: 20px;
            display: inline-block;
        }
        
        .positive { background: #dcfce7; color: #166534; }
        .negative { background: #fecaca; color: #dc2626; }
        
        .calculator {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .results-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .result-card {
            background: #f8fafc;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            border: 1px solid #e5e7eb;
            font-size: 0.9rem;
        }
        
        .profit { color: #10b981; }
        .loss { color: #ef4444; }
        
        .loading {
            text-align: center;
            padding: 15px;
            color: #6b7280;
        }
        
        .connection-status {
            padding: 8px;
            border-radius: 5px;
            margin: 8px 0;
            text-align: center;
            font-size: 0.9rem;
        }
        
        .online { background: #dcfce7; color: #166534; }
        .offline { background: #fecaca; color: #dc2626; }

        .admin-panel {
            background: #fffbeb;
            border: 2px solid #f59e0b;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .module-controls {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .control-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: white;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: #10b981;
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        
        .api-connections {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .api-connection {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            background: white;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .connection-details {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .connection-status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: #10b981;
        }
        
        .connection-status-dot.offline {
            background: #ef4444;
        }
        
        .connection-status-dot.warning {
            background: #f59e0b;
        }
        
        .module-status {
            font-size: 0.7rem;
            padding: 4px 8px;
            border-radius: 20px;
            background: #dcfce7;
            color: #166534;
        }
        
        .status-offline {
            background: #fecaca;
            color: #dc2626;
        }
        
        .advanced-analysis-form {
            position: relative;
            min-height: 400px;
        }
        
        .form-step {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        .form-step.active {
            display: block;
        }
        
        .form-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            gap: 10px;
        }
        
        .form-actions .btn {
            flex: 1;
        }
        
        .selection-summary {
            background: #f8fafc;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
        }
        
        .summary-item {
            padding: 8px;
            background: white;
            border-radius: 8px;
            border: 1px solid #e5e7eb;
            font-size: 0.9rem;
        }
        
        .final-prediction {
            background: linear-gradient(135deg, #10b981, #22c55e);
            color: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .final-prediction.danger {
            background: linear-gradient(135deg, #ef4444, #dc2626);
        }
        
        .final-prediction.warning {
            background: linear-gradient(135deg, #f59e0b, #d97706);
        }
        
        .prediction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .probability-circle {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            width: 100px;
            height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(10px);
            margin: 10px auto;
        }
        
        .circle-value {
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .circle-label {
            font-size: 0.7rem;
            opacity: 0.9;
        }
        
        .decision-text {
            font-size: 1.8rem;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .trading-targets-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .target-card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
            border: 2px solid #e5e7eb;
        }
        
        .target-card.profit {
            border-color: #10b981;
        }
        
        .target-card.loss {
            border-color: #ef4444;
        }
        
        .target-card.time {
            border-color: #f59e0b;
        }
        
        .target-card.risk {
            border-color: #3b82f6;
        }
        
        .target-icon {
            font-size: 1.5rem;
            margin-bottom: 8px;
        }
        
        .target-label {
            font-size: 0.8rem;
            color: #6b7280;
            margin-bottom: 5px;
        }
        
        .target-value {
            font-size: 1.1rem;
            font-weight: bold;
            color: #1f2937;
        }
        
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .analysis-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            border: 1px solid #e5e7eb;
            text-align: center;
        }
        
        .analysis-score {
            font-size: 1.2rem;
            font-weight: bold;
            margin-bottom: 8px;
        }
        
        .analysis-score.good {
            color: #10b981;
        }
        
        .analysis-score.average {
            color: #f59e0b;
        }
        
        .analysis-score.poor {
            color: #ef4444;
        }
        
        .recommendation-list {
            background: white;
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #e5e7eb;
        }
        
        .recommendation-item {
            display: flex;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #f1f5f9;
            font-size: 0.9rem;
        }
        
        .recommendation-item:last-child {
            border-bottom: none;
        }
        
        .recommendation-item i {
            color: #10b981;
            margin-left: 8px;
        }
        
        .risk-warning {
            background: #fef3c7;
            color: #92400e;
            padding: 15px;
            border-radius: 10px;
            border-right: 4px solid #f59e0b;
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-top: 15px;
            font-size: 0.9rem;
        }
        
        .progress-bar {
            width: 100%;
            height: 6px;
            background: #e5e7eb;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #10b981);
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        .data-source-selector {
            background: #f8fafc;
            padding: 12px;
            border-radius: 10px;
            margin: 12px 0;
            border: 1px solid #e5e7eb;
        }
        
        .source-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 8px;
            margin-top: 8px;
        }
        
        .source-option {
            padding: 10px;
            background: white;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        
        .source-option:hover {
            border-color: #3b82f6;
        }
        
        .source-option.active {
            border-color: #10b981;
            background: #f0fdf4;
        }
        
        .real-time-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            background: #10b981;
            border-radius: 50%;
            margin-left: 5px;
            animation: pulse 2s infinite;
        }
        
        .api-status {
            font-size: 0.7rem;
            padding: 4px 8px;
            border-radius: 12px;
            margin-right: 5px;
        }
        
        .api-live {
            background: #dcfce7;
            color: #166534;
        }
        
        .api-offline {
            background: #fecaca;
            color: #dc2626;
        }
        
        .analysis-status {
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 10px;
        }
        
        .analysis-live {
            background: #dcfce7;
            color: #166534;
            border: 1px solid #10b981;
        }
        
        .analysis-offline {
            background: #fef3c7;
            color: #92400e;
            border: 1px solid #f59e0b;
        }
        
        .api-test-result {
            padding: 10px;
            margin: 10px 0;
            border-radius: 8px;
            font-size: 0.9rem;
        }
        
        .api-success {
            background: #f0fdf4;
            color: #166534;
            border-right: 4px solid #10b981;
        }
        
        .api-error {
            background: #fef2f2;
            color: #dc2626;
            border-right: 4px solid #ef4444;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ÛŒ Ø§Ø¶Ø§ÙÙ‡ Ø´Ø¯Ù‡ */
        .xchief-integration {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .proxy-status {
            background: #1f2937;
            color: white;
            padding: 10px;
            border-radius: 8px;
            margin: 8px 0;
            font-size: 0.9rem;
        }

        .market-cap-display {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            gap: 10px;
            margin: 10px 0;
        }

        .market-cap-item {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 8px;
            text-align: center;
            flex: 1;
            min-width: 120px;
        }

        .advanced-analysis-flow {
            background: #f8fafc;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #e5e7eb;
        }

        .analysis-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }

        .analysis-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            right: 0;
            left: 0;
            height: 2px;
            background: #e5e7eb;
            z-index: 1;
        }

        .step {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
            font-weight: bold;
        }

        .step.active {
            border-color: #3b82f6;
            background: #3b82f6;
            color: white;
        }

        .step.completed {
            border-color: #10b981;
            background: #10b981;
            color: white;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        @media (max-width: 768px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                position: fixed;
                top: 0;
                right: 0;
                width: 80%;
                height: 100%;
                z-index: 1000;
                transform: translateX(100%);
                transition: transform 0.3s ease;
                overflow-y: auto;
            }
            
            .sidebar.active {
                transform: translateX(0);
            }
            
            .menu-toggle {
                display: block;
            }
            
            .overlay {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 999;
                display: none;
            }
            
            .overlay.active {
                display: block;
            }
            
            .prediction-main {
                flex-direction: column;
                gap: 15px;
            }
            
            .trading-targets-grid {
                grid-template-columns: 1fr 1fr;
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .analysis-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .summary-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .source-options {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ø¨Ø±Ø§ÛŒ ØªØ¨Ù„Øª */
        @media (min-width: 769px) and (max-width: 1024px) {
            .sidebar {
                display: block;
            }
            
            .menu-toggle {
                display: none;
            }
            
            .dashboard {
                grid-template-columns: 250px 1fr;
            }
            
            .trading-targets-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .results-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .analysis-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        /* Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ø¨Ø±Ø§ÛŒ Ø¯Ø³Ú©ØªØ§Ù¾ */
        @media (min-width: 1025px) {
            .sidebar {
                display: block;
            }
            
            .menu-toggle {
                display: none;
            }
            
            .dashboard {
                grid-template-columns: 250px 1fr;
            }
            
            .trading-targets-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .results-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .analysis-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .summary-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .source-options {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        .proxy-controls {
            background: #1f2937;
            color: white;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .proxy-toggle {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 10px;
        }
        
        .proxy-settings {
            background: rgba(255,255,255,0.1);
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            display: none;
        }
        
        .proxy-settings.active {
            display: block;
        }
        
        .proxy-test-result {
            padding: 8px;
            margin: 8px 0;
            border-radius: 6px;
            font-size: 0.8rem;
        }
        
        .proxy-success {
            background: #dcfce7;
            color: #166534;
        }
        
        .proxy-error {
            background: #fecaca;
            color: #dc2626;
        }
        
        .ai-analysis-flow {
            background: #f8fafc;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            border: 2px solid #e5e7eb;
        }
        
        .ai-steps {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
            position: relative;
        }
        
        .ai-steps::before {
            content: '';
            position: absolute;
            top: 20px;
            right: 0;
            left: 0;
            height: 2px;
            background: #e5e7eb;
            z-index: 1;
        }
        
        .ai-step {
            background: white;
            border: 2px solid #e5e7eb;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
            font-weight: bold;
        }
        
        .ai-step.active {
            border-color: #3b82f6;
            background: #3b82f6;
            color: white;
        }
        
        .ai-step.completed {
            border-color: #10b981;
            background: #10b981;
            color: white;
        }
        
        .ai-step-label {
            position: absolute;
            top: 45px;
            font-size: 0.7rem;
            text-align: center;
            width: 80px;
            right: -20px;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <!-- ØµÙØ­Ù‡ Ù„Ø§Ú¯ÛŒÙ† -->
        <div class="login-box" id="loginPage">
            <h2>Mousa Trading Advisor</h2>
            <form id="loginForm">
                <div class="form-group">
                    <label>Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ</label>
                    <input type="text" id="username" class="form-control" required value="admin">
                </div>
                <div class="form-group">
                    <label>Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±</label>
                    <input type="password" id="password" class="form-control" required value="mousa123">
                </div>
                <button type="submit" class="btn">ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ…</button>
            </form>
            <div style="margin-top: 15px; font-size: 12px; text-align: center; color: #6b7280;">
                <strong>Ø§Ø·Ù„Ø§Ø¹Ø§Øª ØªØ³Øª:</strong> admin / mousa123
            </div>
        </div>

        <!-- Ø¨Ø±Ù†Ø§Ù…Ù‡ Ø§ØµÙ„ÛŒ -->
        <div class="main-app" id="mainApp">
            <div class="app-header">
                <h2>Mousa Trading System 
                    <span class="real-time-indicator"></span>
                    <span class="api-status api-live">LIVE</span>
                </h2>
                <div class="header-controls">
                    <span id="currentTime">--:--:--</span>
                    <button class="menu-toggle" onclick="toggleSidebar()">â˜°</button>
                    <button class="btn" onclick="logout()" style="width: auto; margin-left: 10px; padding: 8px 12px;">Ø®Ø±ÙˆØ¬</button>
                </div>
            </div>

                        <!-- Ú©Ù†ØªØ±Ù„ Ù¾Ø±ÙˆÚ©Ø³ÛŒ Ø¬Ø¯ÛŒØ¯ -->
            <div class="proxy-controls">
                <div class="proxy-toggle">
                    <span>ğŸ›¡ï¸ Ø³ÛŒØ³ØªÙ… Ù¾Ø±ÙˆÚ©Ø³ÛŒ</span>
                    <label class="switch">
                        <input type="checkbox" id="proxyToggle" checked onchange="toggleProxySettings()">
                        <span class="slider"></span>
                    </label>
                </div>
                
                <div class="proxy-settings" id="proxySettings">
                    <div style="display: grid; grid-template-columns: 1fr auto; gap: 10px; margin-bottom: 10px;">
                        <select id="proxyLocation" class="form-control">
                            <option value="germany">Ø¢Ù„Ù…Ø§Ù† ğŸ‡©ğŸ‡ª</option>
                            <option value="netherlands">Ù‡Ù„Ù†Ø¯ ğŸ‡³ğŸ‡±</option>
                            <option value="usa">Ø¢Ù…Ø±ÛŒÚ©Ø§ ğŸ‡ºğŸ‡¸</option>
                            <option value="singapore">Ø³Ù†Ú¯Ø§Ù¾ÙˆØ± ğŸ‡¸ğŸ‡¬</option>
                            <option value="turkey">ØªØ±Ú©ÛŒÙ‡ ğŸ‡¹ğŸ‡·</option>
                        </select>
                        <button class="btn" onclick="testProxyConnection()" style="width: auto; padding: 8px 12px;">
                            ØªØ³Øª Ø§ØªØµØ§Ù„
                        </button>
                    </div>
                    
                    <div id="proxyTestResult"></div>
                    
                    <div style="font-size: 0.8rem; color: #d1d5db;">
                        <div>ğŸ“ Ø¢ÛŒ Ù¾ÛŒ ÙØ¹Ù„ÛŒ: <span id="currentIP">Ø¯Ø± Ø­Ø§Ù„ Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ...</span></div>
                        <div>ğŸŒ Ù…ÙˆÙ‚Ø¹ÛŒØª: <span id="currentLocation">--</span></div>
                    </div>
                </div>
            </div>

            <!-- ØªÛŒÚ©Ø± Ø¨Ø§Ø²Ø§Ø± - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ -->
            <div class="market-ticker">
                <div class="ticker-content" id="tickerContent">
                    <!-- Ù‚ÛŒÙ…Øª Ù‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒ Ø´ÙˆÙ†Ø¯ -->
                </div>
            </div>

            <!-- Ù†Ù…Ø§ÛŒØ´ Ù…Ø§Ø±Ú©Øªâ€ŒÚ©Ù¾ Ùˆ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¬Ù‡Ø§Ù†ÛŒ -->
            <div class="market-cap-display" id="globalMarketData">
                <div class="market-cap-item">
                    <div>ğŸ’° Ù…Ø§Ø±Ú©Øªâ€ŒÚ©Ù¾ Ú©Ù„</div>
                    <div id="totalMarketCap">$2.1T</div>
                    <div style="font-size: 0.8rem; color: #10b981;">+2.3%</div>
                </div>
                <div class="market-cap-item">
                    <div>â‚¿ Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ†</div>
                    <div id="btcDominance">48.5%</div>
                    <div style="font-size: 0.8rem; color: #10b981;">+0.5%</div>
                </div>
                <div class="market-cap-item">
                    <div>ğŸ“ˆ Ø´Ø§Ø®Øµ Ú©Ù„</div>
                    <div id="tehranIndex">2.1M</div>
                    <div style="font-size: 0.8rem; color: #ef4444;">-0.8%</div>
                </div>
                <div class="market-cap-item">
                    <div>ğŸ¥‡ Ø·Ù„Ø§</div>
                    <div id="goldPrice">$1,985</div>
                    <div style="font-size: 0.8rem; color: #10b981;">+1.2%</div>
                </div>
                <div class="market-cap-item">
                    <div>ğŸ’¶ ÛŒÙˆØ±Ùˆ/Ø¯Ù„Ø§Ø±</div>
                    <div id="eurusdRate">1.0925</div>
                    <div style="font-size: 0.8rem; color: #ef4444;">-0.3%</div>
                </div>
            </div>

            <div class="dashboard">
                <!-- Ù†ÙˆØ§Ø± Ú©Ù†Ø§Ø±ÛŒ - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ -->
                <div class="sidebar" id="sidebar">
                    <h3>Ù…Ù†ÙˆÛŒ Ø³ÛŒØ³ØªÙ…</h3>
                    <div class="menu-item active" onclick="showTab('tab-market')">ğŸ“Š Ø¨Ø§Ø²Ø§Ø± Ø²Ù†Ø¯Ù‡</div>
                    <div class="menu-item" onclick="showTab('tab-analysis')">ğŸ§  ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡</div>
                    <div class="menu-item" onclick="showTab('tab-calculator')">ğŸ§® Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ</div>
                    <div class="menu-item" onclick="showTab('tab-admin')">âš™ï¸ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</div>
                    <div class="menu-item" onclick="showTab('tab-advanced')">ğŸ¤– Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa</div>
                    <div class="menu-item" onclick="showTab('tab-news')">ğŸ“° Ø§Ø®Ø¨Ø§Ø± Ù…Ø§Ù„ÛŒ</div>
                    <div class="menu-item" onclick="showTab('tab-saved-analyses')" id="adminSavedAnalyses">ğŸ“Š ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡</div>
                    <div class="menu-item" onclick="showTab('tab-xchief')">ğŸ’ ØµØ±Ø§ÙÛŒ XChief</div>
                    <div class="menu-item" onclick="showTab('tab-mofid')">ğŸ¦ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯</div>
                    
                    <!-- ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ©Ø³ÛŒ -->
                    <div class="proxy-status">
                        <div>ğŸ›¡ï¸ ÙˆØ¶Ø¹ÛŒØª Ù¾Ø±ÙˆÚ©Ø³ÛŒ</div>
                        <div id="proxyStatus">ÙØ¹Ø§Ù„ - Ø§ØªØµØ§Ù„ Ø§ÛŒÙ…Ù†</div>
                        <div style="font-size: 0.7rem; color: #10b981;" id="proxySpeed">Ù¾ÛŒÙ†Ú¯: 45ms</div>
                    </div>
                    
                    <div style="margin-top: 30px;">
                        <div class="connection-status online" id="connectionStatus">
                            ğŸ”— Ø¢Ù†Ù„Ø§ÛŒÙ† - Ø§ØªØµØ§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø±
                        </div>
                        <div style="font-size: 12px; color: #9ca3af; margin-top: 10px;">
                            Ø¢Ø®Ø±ÛŒÙ† Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ: <span id="lastUpdate">--:--:--</span>
                        </div>
                    </div>
                </div>

                <!-- Ù…Ø­ØªÙˆØ§ÛŒ Ø§ØµÙ„ÛŒ -->
                <div class="main-content">
                    <!-- ØªØ¨ Ø¨Ø§Ø²Ø§Ø± Ø²Ù†Ø¯Ù‡ - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ -->
                    <div class="tab-content active" id="tab-market">
                        <h2>Ø¨Ø§Ø²Ø§Ø± Ø²Ù†Ø¯Ù‡ - Ø§ØªØµØ§Ù„ Ø¨Ù‡ ØªÙ…Ø§Ù… ØµØ±Ø§ÙÛŒâ€ŒÙ‡Ø§</h2>
                        
                        <!-- Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù†Ø¨Ø¹ Ø¯Ø§Ø¯Ù‡ - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ -->
                        <div class="data-source-selector">
                            <h4>ğŸ“¡ Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù†Ø¨Ø¹ Ø¯Ø§Ø¯Ù‡</h4>
                            <div class="source-options">
                                <div class="source-option active" onclick="selectDataSource('coingecko')">
                                    <div>ğŸª™ CoinGecko</div>
                                    <small>Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„</small>
                                </div>
                                <div class="source-option" onclick="selectDataSource('binance')">
                                    <div>ğŸ’ Binance</div>
                                    <small>Ø¯Ù‚ÛŒÙ‚â€ŒØªØ±ÛŒÙ† Ù‚ÛŒÙ…Øªâ€ŒÙ‡Ø§</small>
                                </div>
                                <div class="source-option" onclick="selectDataSource('xchief')">
                                    <div>ğŸš€ XChief</div>
                                    <small>ØµØ±Ø§ÙÛŒ Ø§Ø®ØªØµØ§ØµÛŒ</small>
                                </div>
                                <div class="source-option" onclick="selectDataSource('alphavantage')">
                                    <div>ğŸ’µ Alpha Vantage</div>
                                    <small>ÙØ§Ø±Ú©Ø³ Ùˆ Ø³Ù‡Ø§Ù…</small>
                                </div>
                                <div class="source-option" onclick="selectDataSource('tsetmc')">
                                    <div>ğŸ“ˆ TSETMC</div>
                                    <small>Ø¨ÙˆØ±Ø³ ØªÙ‡Ø±Ø§Ù†</small>
                                </div>
                                <div class="source-option" onclick="selectDataSource('mofid')">
                                    <div>ğŸ¦ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯</div>
                                    <small>Ø¨ÙˆØ±Ø³ Ø§ÛŒØ±Ø§Ù†</small>
                                </div>
                            </div>
                        </div>

                        <!-- ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„ Ù¾Ø±ÙˆÚ©Ø³ÛŒ -->
                        <div class="proxy-status" style="background: #1e40af; margin: 10px 0;">
                            <div style="display: flex; justify-content: between; align-items: center;">
                                <div>
                                    <strong>ğŸ›¡ï¸ Ø³ÛŒØ³ØªÙ… Ù¾Ø±ÙˆÚ©Ø³ÛŒ ÙØ¹Ø§Ù„</strong>
                                    <div style="font-size: 0.8rem;">Ø§ØªØµØ§Ù„ Ø§ÛŒÙ…Ù† Ø¨Ù‡ ØªÙ…Ø§Ù… Ø³Ø±ÙˆÛŒØ³â€ŒÙ‡Ø§</div>
                                </div>
                                <div id="proxyConnections">
                                    <span style="background: #10b981; padding: 2px 8px; border-radius: 12px; font-size: 0.7rem;">
                                        Û¸ Ø§ØªØµØ§Ù„ ÙØ¹Ø§Ù„
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="loading" id="marketLoading">
                            Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±...
                        </div>
                        <div id="marketData" style="display: none;">
                            <!-- Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒ Ø´ÙˆÙ†Ø¯ -->
                        </div>
                    </div>

                    <!-- ØªØ¨ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ -->
                    <div class="tab-content" id="tab-analysis">
                        <h2>ğŸ§  ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Mousa</h2>
                        
                        <!-- ÙÙ„ÙˆÛŒ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ -->
                        <div class="advanced-analysis-flow">
                            <div class="analysis-steps">
                                <div class="step active">Û±</div>
                                <div class="step">Û²</div>
                                <div class="step">Û³</div>
                                <div class="step">Û´</div>
                            </div>
                            <div style="text-align: center; font-size: 0.9rem; color: #6b7280;">
                                Ù…Ø±Ø­Ù„Ù‡ Û±: Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø± â†’ Ù…Ø±Ø­Ù„Ù‡ Û²: Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§Ø¯ â†’ Ù…Ø±Ø­Ù„Ù‡ Û³: ØªÙ†Ø¸ÛŒÙ…Ø§Øª â†’ Ù…Ø±Ø­Ù„Ù‡ Û´: Ù†ØªÛŒØ¬Ù‡
                            </div>
                        </div>
                        
                        <div class="calculator">
                            <div class="advanced-analysis-form">
                                <!-- Ù…Ø±Ø­Ù„Ù‡ 1: Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø± -->
                                <div class="form-step active" id="analysisStep1">
                                    <h4>ğŸ“ˆ Ù…Ø±Ø­Ù„Ù‡ 1: Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø±</h4>
                                    <div class="form-group">
                                        <label>Ø¨Ø§Ø²Ø§Ø± Ù…ÙˆØ±Ø¯ ØªØ­Ù„ÛŒÙ„</label>
                                        <select id="analysisMarket" class="form-control" onchange="onMarketChange()">
                                            <option value="">-- Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø± --</option>
                                            <option value="crypto">Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„</option>
                                            <option value="tehran">Ø¨ÙˆØ±Ø³ ØªÙ‡Ø±Ø§Ù†</option>
                                            <option value="forex">ÙØ§Ø±Ú©Ø³</option>
                                            <option value="stocks">Ø³Ù‡Ø§Ù… Ø¨ÛŒÙ†â€ŒØ§Ù„Ù…Ù„Ù„ÛŒ</option>
                                        </select>
                                    </div>
                                    <button class="btn" onclick="nextAnalysisStep(1)">
                                        Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ â†’
                                    </button>
                                </div>

                                <!-- Ù…Ø±Ø­Ù„Ù‡ 2: Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§Ø¯ -->
                                <div class="form-step" id="analysisStep2">
                                    <h4>ğŸ·ï¸ Ù…Ø±Ø­Ù„Ù‡ 2: Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§Ø¯</h4>
                                    <div class="form-group">
                                        <label>Ù†Ù…Ø§Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ</label>
                                        <select id="analysisSymbol" class="form-control">
                                            <option value="">-- Ù„Ø·ÙØ§ Ù†Ù…Ø§Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ --</option>
                                        </select>
                                    </div>
                                    <div class="form-actions">
                                        <button class="btn" onclick="prevAnalysisStep(2)">
                                            â† Ù…Ø±Ø­Ù„Ù‡ Ù‚Ø¨Ù„
                                        </button>
                                        <button class="btn" onclick="nextAnalysisStep(2)">
                                            Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ â†’
                                        </button>
                                    </div>
                                </div>

                                <!-- Ù…Ø±Ø­Ù„Ù‡ 3: ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø±Ù…Ø§ÛŒÙ‡ -->
                                <div class="form-step" id="analysisStep3">
                                    <h4>ğŸ’µ Ù…Ø±Ø­Ù„Ù‡ 3: ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø³Ø±Ù…Ø§ÛŒÙ‡</h4>
                                    <div class="form-group">
                                        <label>Ù…Ù‚Ø¯Ø§Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡ (Ø¯Ù„Ø§Ø±)</label>
                                        <input type="number" id="analysisAmount" class="form-control" value="1000" min="10">
                                    </div>
                                    <div class="form-group">
                                        <label>Ø§Ù‡Ø±Ù…</label>
                                        <select id="analysisLeverage" class="form-control">
                                            <option value="1">1x</option>
                                            <option value="5">5x</option>
                                            <option value="10">10x</option>
                                            <option value="20">20x</option>
                                        </select>
                                    </div>
                                    <div class="form-actions">
                                        <button class="btn" onclick="prevAnalysisStep(3)">
                                            â† Ù…Ø±Ø­Ù„Ù‡ Ù‚Ø¨Ù„
                                        </button>
                                        <button class="btn" onclick="runAdvancedAnalysis()">
                                            ğŸ” Ø§Ø¬Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <div id="analysisResults" style="display: none;">
                                <h4>Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„ Mousa</h4>
                                <div id="resultsContent"></div>
                                
                                <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ action Ø¬Ø¯ÛŒØ¯ -->
                                <div class="form-actions" style="margin-top: 20px;">
                                    <button class="btn" onclick="saveAnalysisToStorage()" style="background: #10b981;">
                                        ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªØ­Ù„ÛŒÙ„
                                    </button>
                                    <button class="btn" onclick="resetToMarketSelection()" style="background: #3b82f6;">
                                        ğŸ  Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø±
                                    </button>
                                    <button class="btn" onclick="startNewAnalysis()" style="background: #f59e0b;">
                                        ğŸ”„ ØªØ­Ù„ÛŒÙ„ Ø¬Ø¯ÛŒØ¯
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ Ø¬Ø¯ÛŒØ¯: ØµØ±Ø§ÙÛŒ XChief -->
                    <div class="tab-content" id="tab-xchief">
                        <h2>ğŸ’ ØµØ±Ø§ÙÛŒ XChief - Ø§ØªØµØ§Ù„ ÛŒÚ©Ù¾Ø§Ø±Ú†Ù‡</h2>
                        
                        <div class="xchief-integration">
                            <h4>ğŸš€ Ø§ØªØµØ§Ù„ Ø¨Ù‡ ØµØ±Ø§ÙÛŒ XChief</h4>
                            <p>Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ</p>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">âš¡</div>
                                    <div>Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§</div>
                                    <div style="font-size: 0.8rem; opacity: 0.9;">Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¨Ø§ ØªØ§Ø®ÛŒØ± Ú©Ù…</div>
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">ğŸ›¡ï¸</div>
                                    <div>Ø§Ù…Ù†ÛŒØª Ù¾ÛŒØ´Ø±ÙØªÙ‡</div>
                                    <div style="font-size: 0.8rem; opacity: 0.9;">Ø­ÙØ§Ø¸Øª Ú†Ù†Ø¯Ù„Ø§ÛŒÙ‡</div>
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">ğŸ’°</div>
                                    <div>Ú©Ø§Ø±Ù…Ø²Ø¯ Ø±Ù‚Ø§Ø¨ØªÛŒ</div>
                                    <div style="font-size: 0.8rem; opacity: 0.9;">Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±ÛŒÙ† Ù†Ø±Ø®â€ŒÙ‡Ø§</div>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn" onclick="connectXChief()" style="background: white; color: #667eea;">
                                    ğŸ”— Ø§ØªØµØ§Ù„ Ø¨Ù‡ XChief
                                </button>
                                <button class="btn" onclick="showXChiefMarkets()" style="background: rgba(255,255,255,0.2); border: 1px solid white;">
                                    ğŸ“Š Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¨Ø§Ø²Ø§Ø±Ù‡Ø§
                                </button>
                            </div>
                        </div>
                        
                        <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø¨ XChief -->
                        <div id="xchiefAccountInfo" style="display: none;">
                            <h4>ğŸ’¼ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø¨ XChief</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 15px 0;">
                                <div class="result-card">
                                    <div>Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ú©Ù„</div>
                                    <div id="xchiefBalance">$0</div>
                                </div>
                                <div class="result-card">
                                    <div>Ø³ÙˆØ¯/Ø¶Ø±Ø± Ø§Ù…Ø±ÙˆØ²</div>
                                    <div id="xchiefPnL" class="profit">+$0</div>
                                </div>
                                <div class="result-card">
                                    <div>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
                                    <div id="xchiefTrades">0</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ Ø¬Ø¯ÛŒØ¯: Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯ -->
                    <div class="tab-content" id="tab-mofid">
                        <h2>ğŸ¦ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯ - Ø§ØªØµØ§Ù„ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Ø¨ÙˆØ±Ø³ Ø§ÛŒØ±Ø§Ù†</h2>
                        
                        <div class="xchief-integration" style="background: linear-gradient(135deg, #059669, #10b981);">
                            <h4>ğŸ“ˆ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯</h4>
                            <p>Ø¯Ø³ØªØ±Ø³ÛŒ Ù…Ø³ØªÙ‚ÛŒÙ… Ø¨Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø¨ÙˆØ±Ø³ Ùˆ ÙØ±Ø§Ø¨ÙˆØ±Ø³ Ø§ÛŒØ±Ø§Ù† Ø¨Ø§ Ù‚Ø§Ø¨Ù„ÛŒØªâ€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</p>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">ğŸ›ï¸</div>
                                    <div>Ø±Ø³Ù…ÛŒ Ùˆ Ù…Ø¹ØªØ¨Ø±</div>
                                    <div style="font-size: 0.8rem; opacity: 0.9;">Ø¯Ø§Ø±Ø§ÛŒ Ù…Ø¬ÙˆØ² Ø±Ø³Ù…ÛŒ</div>
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">âš¡</div>
                                    <div>Ø³Ø±Ø¹Øª Ø¨Ø§Ù„Ø§</div>
                                    <div style="font-size: 0.8rem; opacity: 0.9;">Ø¯Ø³ØªØ±Ø³ÛŒ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</div>
                                </div>
                                <div style="background: rgba(255,255,255,0.2); padding: 15px; border-radius: 10px; text-align: center;">
                                    <div style="font-size: 1.5rem; margin-bottom: 8px;">ğŸ“Š</div>
                                    <div>ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡</div>
                                    <div style="font-size: 0.8rem; opacity: 0.9;">ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØªØ®ØµØµÛŒ</div>
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button class="btn" onclick="connectMofid()" style="background: white; color: #059669;">
                                    ğŸ”— Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ù…ÙÛŒØ¯
                                </button>
                                <button class="btn" onclick="showMofidMarkets()" style="background: rgba(255,255,255,0.2); border: 1px solid white;">
                                    ğŸ“Š Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ù†Ù…Ø§Ø¯Ù‡Ø§
                                </button>
                            </div>
                        </div>
                        
                        <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø¨ Ù…ÙÛŒØ¯ -->
                        <div id="mofidAccountInfo" style="display: none;">
                            <h4>ğŸ’¼ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø­Ø³Ø§Ø¨ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯</h4>
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 15px 0;">
                                <div class="result-card">
                                    <div>Ù…ÙˆØ¬ÙˆØ¯ÛŒ Ø±ÛŒØ§Ù„ÛŒ</div>
                                    <div id="mofidBalance">0 Ø±ÛŒØ§Ù„</div>
                                </div>
                                <div class="result-card">
                                    <div>Ø³ÙˆØ¯/Ø¶Ø±Ø± Ø§Ù…Ø±ÙˆØ²</div>
                                    <div id="mofidPnL" class="profit">+0 Ø±ÛŒØ§Ù„</div>
                                </div>
                                <div class="result-card">
                                    <div>ØªØ¹Ø¯Ø§Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª</div>
                                    <div id="mofidTrades">0</div>
                                </div>
                            </div>
                            
                            <!-- Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù¾Ø±ØªØ±Ø§Ú©Ù†Ø´ -->
                            <h4>ğŸ”¥ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù¾Ø±ØªØ±Ø§Ú©Ù†Ø´ Ø§Ù…Ø±ÙˆØ²</h4>
                            <div id="mofidHotSymbols" style="margin-top: 15px;">
                                <!-- Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù¾Ø±ØªØ±Ø§Ú©Ù†Ø´ Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ -->
                    <div class="tab-content" id="tab-calculator">
                        <h2>Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ</h2>
                        <div class="calculator">
                            <div>
                                <h4>ÙˆØ±ÙˆØ¯ÛŒ Ù‡Ø§</h4>
                                <div class="form-group">
                                    <label>Ù†Ù…Ø§Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ</label>
                                    <select id="calcSymbol" class="form-control" onchange="updateCalcPrice()">
                                        <option value="bitcoin">Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ† (BTC)</option>
                                        <option value="ethereum">Ø§ØªØ±ÛŒÙˆÙ… (ETH)</option>
                                        <option value="binancecoin">Ø¨Ø§ÛŒÙ†Ù†Ø³ Ú©ÙˆÛŒÙ† (BNB)</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø§ÙˆÙ„ÛŒÙ‡ (Ø¯Ù„Ø§Ø±)</label>
                                    <input type="number" id="calcAmount" class="form-control" value="1000" min="10">
                                </div>
                                
                                <div class="form-group">
                                    <label>Ù†ÙˆØ¹ Ù¾ÙˆØ²ÛŒØ´Ù†</label>
                                    <select id="calcPosition" class="form-control">
                                        <option value="long">Ù„Ø§Ù†Ú¯ (Ø®Ø±ÛŒØ¯)</option>
                                        <option value="short">Ø´ÙˆØ±Øª (ÙØ±ÙˆØ´)</option>
                                    </select>
                                </div>
                                
                                <div class="form-group">
                                    <label>Ø§Ù‡Ø±Ù…: <span id="calcLeverageValue">5x</span></label>
                                    <input type="range" id="calcLeverage" class="form-control" min="1" max="20" value="5" oninput="updateCalcLeverage()">
                                </div>
                                
                                <div class="form-group">
                                    <label>ØªØºÛŒÛŒØ± Ù‚ÛŒÙ…Øª Ù…ÙˆØ±Ø¯ Ø§Ù†ØªØ¸Ø§Ø± (%)</label>
                                    <input type="number" id="calcPriceChange" class="form-control" value="10" step="0.1">
                                </div>
                            </div>
                            
                            <div>
                                <h4>Ù†ØªØ§ÛŒØ¬ Ù…Ø­Ø§Ø³Ø¨Ø§Øª</h4>
                                <div class="results-grid">
                                    <div class="result-card">
                                        <div>Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø§ÙˆÙ„ÛŒÙ‡</div>
                                        <div id="calcInitial">$1,000</div>
                                    </div>
                                    <div class="result-card">
                                        <div>Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø¨Ø§ Ø§Ù‡Ø±Ù…</div>
                                        <div id="calcLeveraged">$5,000</div>
                                    </div>
                                    <div class="result-card">
                                        <div>Ø³ÙˆØ¯ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ</div>
                                        <div id="calcProfit" class="profit">+$500</div>
                                    </div>
                                    <div class="result-card">
                                        <div>Ø¶Ø±Ø± Ø§Ø­ØªÙ…Ø§Ù„ÛŒ</div>
                                        <div id="calcLoss" class="loss">-$500</div>
                                    </div>
                                </div>
                                
                                <div style="margin-top: 20px;">
                                    <button class="btn" onclick="calculateTrade()">Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø³ÙˆØ¯/Ø¶Ø±Ø±</button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª -->
                    <div class="tab-content" id="tab-admin">
                        <h2>Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª Mousa</h2>
                        <div class="admin-panel">
                            <h3>ğŸ›¡ï¸ Ú©Ù†ØªØ±Ù„ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</h3>
                            <p>ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ø³ÛŒØ³ØªÙ… - ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±Ø§Ù† Ø³ÛŒØ³ØªÙ…</p>
                            
                            <!-- ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„ API -->
                            <div style="margin-top: 20px;">
                                <h4>ğŸ”— ÙˆØ¶Ø¹ÛŒØª Ø§ØªØµØ§Ù„ API</h4>
                                <div class="api-connections" id="apiConnections">
                                    <!-- Ø§ØªØµØ§Ù„Ø§Øª API Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                                </div>
                            </div>

                            <div style="margin-top: 20px;">
                                <h4>Ú©Ù†ØªØ±Ù„ Ù…Ø§Ú˜ÙˆÙ„â€ŒÙ‡Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ÛŒ</h4>
                                <div class="module-controls">
                                    <div class="control-item">
                                        <span>Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</span>
                                        <label class="switch">
                                            <input type="checkbox" id="toggleEnhancedAI" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="control-item">
                                        <span>ØªØ­Ù„ÛŒÙ„ Ø§Ø®Ø¨Ø§Ø± Ø±ÙˆÛŒØªØ±Ø²</span>
                                        <label class="switch">
                                            <input type="checkbox" id="toggleReuters" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="control-item">
                                        <span>ØªØ­Ù„ÛŒÙ„ Ø§Ø®Ø¨Ø§Ø± Ø¨ÛŒâ€ŒØ¨ÛŒâ€ŒØ³ÛŒ</span>
                                        <label class="switch">
                                            <input type="checkbox" id="toggleBBC" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="control-item">
                                        <span>ØªØ­Ù„ÛŒÙ„ Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª</span>
                                        <label class="switch">
                                            <input type="checkbox" id="toggleVolumeAnalysis" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="control-item">
                                        <span>ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ Ù¾ÛŒØ´Ø±ÙØªÙ‡</span>
                                        <label class="switch">
                                            <input type="checkbox" id="toggleTechnical" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                    <div class="control-item">
                                        <span>ØªØ­Ù„ÛŒÙ„ Ø³Ù†ØªÛŒÙ…Ù†Øª Ø¨Ø§Ø²Ø§Ø±</span>
                                        <label class="switch">
                                            <input type="checkbox" id="toggleSentiment" checked>
                                            <span class="slider"></span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- ØªØ¨ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa -->
                    <div class="tab-content" id="tab-advanced">
                        <h2>ğŸ¤– Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa - ØªØ­Ù„ÛŒÙ„ Ú†Ù†Ø¯Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ</h2>
                        
                        <div class="calculator">
                            <div class="advanced-analysis-form">
                                <!-- Ù…Ø±Ø­Ù„Ù‡ 1: Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø± -->
                                <div class="form-step active" id="step1">
                                    <h4>ğŸ“ˆ Ù…Ø±Ø­Ù„Ù‡ 1: Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø±</h4>
                                    <div class="form-group">
                                        <label>Ø¨Ø§Ø²Ø§Ø± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±</label>
                                        <select class="form-control" id="marketSelect">
                                            <option value="">-- Ù„Ø·ÙØ§ Ø¨Ø§Ø²Ø§Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ --</option>
                                            <option value="crypto">Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„</option>
                                            <option value="forex">ÙØ§Ø±Ú©Ø³</option>
                                            <option value="stocks">Ø¨ÙˆØ±Ø³ Ø³Ù‡Ø§Ù…</option>
                                            <option value="commodities">Ú©Ø§Ù„Ø§Ù‡Ø§</option>
                                        </select>
                                    </div>
                                    <button class="btn" onclick="nextStep(1)">
                                        Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯
                                    </button>
                                </div>

                                <!-- Ù…Ø±Ø­Ù„Ù‡ 2: Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§Ø¯ -->
                                <div class="form-step" id="step2">
                                    <h4>ğŸ·ï¸ Ù…Ø±Ø­Ù„Ù‡ 2: Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§Ø¯</h4>
                                    <div class="form-group">
                                        <label>Ù†Ù…Ø§Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ</label>
                                        <select class="form-control" id="symbolSelect">
                                            <option value="">-- Ù„Ø·ÙØ§ Ù†Ù…Ø§Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ --</option>
                                            <!-- Ù†Ù…Ø§Ø¯Ù‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø§Ø²Ø§Ø± Ù¾Ø± Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                                        </select>
                                    </div>
                                    <div class="form-actions">
                                        <button class="btn" onclick="prevStep(2)">
                                            Ù…Ø±Ø­Ù„Ù‡ Ù‚Ø¨Ù„
                                        </button>
                                        <button class="btn" onclick="nextStep(2)">
                                            Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯
                                        </button>
                                    </div>
                                </div>

                                <!-- Ù…Ø±Ø­Ù„Ù‡ 3: Ù…Ù‚Ø¯Ø§Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ -->
                                <div class="form-step" id="step3">
                                    <h4>ğŸ’µ Ù…Ø±Ø­Ù„Ù‡ 3: Ù…Ù‚Ø¯Ø§Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ</h4>
                                    <div class="form-group">
                                        <label>Ù…Ù‚Ø¯Ø§Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡ (Ø¯Ù„Ø§Ø±)</label>
                                        <input type="number" class="form-control" id="investmentAmount" 
                                               placeholder="Ù…Ø«Ø§Ù„: 1000" min="10" step="10" value="1000">
                                    </div>
                                    <div class="form-actions">
                                        <button class="btn" onclick="prevStep(3)">
                                            Ù…Ø±Ø­Ù„Ù‡ Ù‚Ø¨Ù„
                                        </button>
                                        <button class="btn" onclick="nextStep(3)">
                                            Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯
                                        </button>
                                    </div>
                                </div>

                                <!-- Ù…Ø±Ø­Ù„Ù‡ 4: Ø²Ù…Ø§Ù† Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ Ù†ØªÛŒØ¬Ù‡ -->
                                <div class="form-step" id="step4">
                                    <h4>â° Ù…Ø±Ø­Ù„Ù‡ 4: Ø²Ù…Ø§Ù† Ø±Ø³ÛŒØ¯Ù† Ø¨Ù‡ Ù†ØªÛŒØ¬Ù‡</h4>
                                    <div class="form-group">
                                        <label>Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø±</label>
                                        <select class="form-control" id="timeframeSelect">
                                            <option value="">-- Ù„Ø·ÙØ§ Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ --</option>
                                            <option value="5min">5 Ø¯Ù‚ÛŒÙ‚Ù‡</option>
                                            <option value="15min">15 Ø¯Ù‚ÛŒÙ‚Ù‡</option>
                                            <option value="1h">1 Ø³Ø§Ø¹Øª</option>
                                            <option value="4h">4 Ø³Ø§Ø¹Øª</option>
                                            <option value="1d">1 Ø±ÙˆØ²</option>
                                            <option value="3d">3 Ø±ÙˆØ²</option>
                                            <option value="1w">1 Ù‡ÙØªÙ‡</option>
                                        </select>
                                    </div>
                                    <div class="form-actions">
                                        <button class="btn" onclick="prevStep(4)">
                                            Ù…Ø±Ø­Ù„Ù‡ Ù‚Ø¨Ù„
                                        </button>
                                        <button class="btn" onclick="runMousaAIAnalysis()">
                                            Ø§Ø¬Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <!-- Ø®Ù„Ø§ØµÙ‡ Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ -->
                            <div id="selectionSummary" class="selection-summary" style="display: none; margin-top: 20px;">
                                <h5>ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§ÛŒ Ø´Ù…Ø§:</h5>
                                <div id="summaryContent"></div>
                            </div>

                            <!-- Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„ -->
                            <div id="mousaAIResults" style="display: none; margin-top: 30px;"></div>
                        </div>
                    </div>

                    <!-- ØªØ¨ Ø§Ø®Ø¨Ø§Ø± -->
                    <div class="tab-content" id="tab-news">
                        <h2>ğŸ“° Ø§Ø®Ø¨Ø§Ø± Ù…Ø§Ù„ÛŒ Ù„Ø­Ø¸Ù‡â€ŒØ§ÛŒ</h2>
                        
                        <div class="data-source-selector">
                            <h4>Ù…Ù†Ø¨Ø¹ Ø§Ø®Ø¨Ø§Ø±</h4>
                            <div class="source-options">
                                <div class="source-option active" onclick="selectNewsSource('bloomberg')">
                                    <div>ğŸŒ Bloomberg</div>
                                    <small>Ø¨Ø§Ø²Ø§Ø±Ù‡Ø§ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ</small>
                                </div>
                                <div class="source-option" onclick="selectNewsSource('reuters')">
                                    <div>ğŸ“Š Reuters</div>
                                    <small>Ø§Ø®Ø¨Ø§Ø± Ø§Ù‚ØªØµØ§Ø¯ÛŒ</small>
                                </div>
                                <div class="source-option" onclick="selectNewsSource('coindesk')">
                                    <div>â‚¿ CoinDesk</div>
                                    <small>Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„</small>
                                </div>
                                <div class="source-option" onclick="selectNewsSource('cointelegraph')">
                                    <div>ğŸ”— Cointelegraph</div>
                                    <small>Ø¨Ù„Ø§Ú©Ú†ÛŒÙ† Ùˆ Ú©Ø±ÛŒÙ¾ØªÙˆ</small>
                                </div>
                            </div>
                        </div>
                        
                        <div class="loading" id="newsLoading">
                            Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¢Ø®Ø±ÛŒÙ† Ø§Ø®Ø¨Ø§Ø± Ø§Ø² <span id="newsSourceName">Bloomberg</span>...
                        </div>
                        
                        <div id="newsData" style="display: none;">
                            <!-- Ø§Ø®Ø¨Ø§Ø± Ø§ÛŒÙ†Ø¬Ø§ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯ -->
                        </div>
                    </div>

                    <!-- ØªØ¨ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ -->
                    <div class="tab-content" id="tab-saved-analyses">
                        <h2>ğŸ“Š ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ - Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª</h2>
                        
                        <div class="admin-panel">
                            <h4>ØªØ§Ø±ÛŒØ®Ú†Ù‡ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯Ù‡</h4>
                            
                            <div style="margin-bottom: 15px;">
                                <button class="btn" onclick="loadSavedAnalyses()" style="width: auto; margin-left: 10px;">
                                    ğŸ”„ Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ
                                </button>
                                <button class="btn" onclick="clearAllAnalyses()" style="width: auto; background: #ef4444;">
                                    ğŸ—‘ï¸ Ø­Ø°Ù Ù‡Ù…Ù‡
                                </button>
                            </div>
                            
                            <div id="savedAnalysesList">
                                <!-- Ù„ÛŒØ³Øª ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- overlay Ø¨Ø±Ø§ÛŒ Ù…Ù†ÙˆÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ -->
        <div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
    </div>

    <script>
        // API Keys Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡
        const API_CONFIG = {
            COINGECKO: 'https://api.coingecko.com/api/v3',
            BINANCE: 'https://api.binance.com/api/v3',
            XCHIEF: 'https://api.xchief.com/v1',
            ALPHA_VANTAGE: 'https://www.alphavantage.co/query',
            TSETMC: 'http://cdn.tsetmc.com/api',
            MOFID: 'https://api.mofidtrader.com/v1', // Ø¢Ø¯Ø±Ø³ ÙØ±Ø¶ÛŒ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
            PROXY_SERVER: 'https://cors-anywhere.herokuapp.com/'
        };

        // Ø³ÛŒØ³ØªÙ… Ù¾Ø±ÙˆÚ©Ø³ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        class AdvancedProxy {
            constructor() {
                this.proxyEnabled = true;
                this.connections = new Map();
                this.proxyStats = {
                    totalRequests: 0,
                    failedRequests: 0,
                    avgResponseTime: 0
                };
            }

            async fetchWithProxy(url, options = {}) {
                if (!this.proxyEnabled) {
                    return await fetch(url, options);
                }

                const proxyUrl = `${API_CONFIG.PROXY_SERVER}${url}`;
                const startTime = Date.now();
                
                try {
                    const response = await fetch(proxyUrl, {
                        ...options,
                        headers: {
                            ...options.headers,
                            'X-Requested-With': 'XMLHttpRequest'
                        }
                    });
                    const endTime = Date.now();
                    
                    this.proxyStats.totalRequests++;
                    this.proxyStats.avgResponseTime = 
                        (this.proxyStats.avgResponseTime * (this.proxyStats.totalRequests - 1) + (endTime - startTime)) 
                        / this.proxyStats.totalRequests;
                    
                    this.connections.set(url, {
                        status: 'success',
                        responseTime: endTime - startTime,
                        lastUpdate: new Date()
                    });
                    
                    return response;
                } catch (error) {
                    this.proxyStats.failedRequests++;
                    this.connections.set(url, {
                        status: 'failed',
                        error: error.message,
                        lastUpdate: new Date()
                    });
                    
                    // Ø§Ú¯Ø± Ù¾Ø±ÙˆÚ©Ø³ÛŒ Ú©Ø§Ø± Ù†Ú©Ø±Ø¯ØŒ Ù…Ø³ØªÙ‚ÛŒÙ…Ø§Ù‹ ØªÙ„Ø§Ø´ Ú©Ù†
                    try {
                        const directResponse = await fetch(url, options);
                        if (directResponse.ok) {
                            this.connections.set(url, {
                                status: 'success_direct',
                                responseTime: Date.now() - startTime,
                                lastUpdate: new Date()
                            });
                            return directResponse;
                        }
                    } catch (directError) {
                        console.error('Direct connection also failed:', directError);
                    }
                    
                    throw error;
                }
            }

            getProxyStatus() {
                const successRate = ((this.proxyStats.totalRequests - this.proxyStats.failedRequests) / this.proxyStats.totalRequests) * 100;
                return {
                    enabled: this.proxyEnabled,
                    successRate: successRate || 100,
                    avgResponseTime: this.proxyStats.avgResponseTime,
                    activeConnections: this.connections.size
                };
            }
        }

        // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ Ù¾Ø±ÙˆÚ©Ø³ÛŒ
        const advancedProxy = new AdvancedProxy();

        // Ù…Ù†Ø§Ø¨Ø¹ Ø¯Ø§Ø¯Ù‡
        let currentDataSource = 'coingecko';
        let currentNewsSource = 'reuters';
        let currentPrices = {};
        let updateInterval;
        let currentStep = 1;
        let currentAnalysisStep = 1;
        let userSelections = {};
        let isOnline = true;
        let xchiefConnected = false;
        let mofidConnected = false;

        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§ - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡
        const symbolsData = {
            crypto: [
                'Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ† (BTC)', 'Ø§ØªØ±ÛŒÙˆÙ… (ETH)', 'Ø¨Ø§ÛŒÙ†Ù†Ø³ Ú©ÙˆÛŒÙ† (BNB)', 
                'Ø±ÛŒÙ¾Ù„ (XRP)', 'Ú©Ø§Ø±Ø¯Ø§Ù†Ùˆ (ADA)', 'Ø³ÙˆÙ„Ø§Ù†Ø§ (SOL)', 'Ø¯ÙˆØ¬ Ú©ÙˆÛŒÙ† (DOGE)',
                'XCHIEF Token (XCF)', 'Ù¾ÙˆÙ„Ú©Ø§Ø¯Ø§Øª (DOT)', 'Ù„Ø§ÛŒØªâ€ŒÚ©ÙˆÛŒÙ† (LTC)'
            ],
            tehran: [
                'Ø´Ø§Ø®Øµ Ú©Ù„', 'Ø´Ø§Ø®Øµ Ù‡Ù… ÙˆØ²Ù†', 'ÙÙ…Ù„ÛŒ', 'ÙÙˆÙ„Ø§Ø¯', 'Ú©Ú¯Ù„',
                'ÙˆØ¨ØµØ§Ø¯Ø±', 'Ø´Ù¾Ù†Ø§', 'Ø®Ø³Ø§Ù¾Ø§', 'Ø´ØªØ±Ø§Ù†', 'ÙˆØ¨Ù…Ù„Øª'
            ],
            forex: [
                'EUR/USD', 'GBP/USD', 'USD/JPY', 'AUD/USD', 'USD/CAD',
                'USD/CHF', 'NZD/USD', 'EUR/GBP'
            ],
            stocks: [
                'Ø§Ù¾Ù„ (AAPL)', 'Ù…Ø§ÛŒÚ©Ø±ÙˆØ³Ø§ÙØª (MSFT)', 'Ø¢Ù…Ø§Ø²ÙˆÙ† (AMZN)', 
                'ØªØ³Ù„Ø§ (TSLA)', 'ÙÛŒØ³Ø¨ÙˆÚ© (META)', 'Ú¯ÙˆÚ¯Ù„ (GOOGL)',
                'Ù†ÙØªÛŒØ§ (NFLX)', 'Ù†ÙˆÛŒØ¯ÛŒØ§ (NVDA)'
            ]
        };

        // Ù…Ø¯ÛŒØ±ÛŒØª Ù„Ø§Ú¯ÛŒÙ†
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            if (username === "admin" && password === "mousa123") {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('mainApp').style.display = 'block';
                initializeApp();
            } else {
                alert('Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ ÛŒØ§ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø§Ø´ØªØ¨Ø§Ù‡ Ø§Ø³Øª!');
            }
        });

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ù†Ø§Ù…Ù‡ - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡
        async function initializeApp() {
            updateTime();
            setInterval(updateTime, 1000);
            
            // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ù¾Ø±ÙˆÚ©Ø³ÛŒ
            await initializeProxySystem();
            
            // ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ APIÙ‡Ø§
            await testAPIConnections();
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            await loadExchangeSymbols(currentDataSource);
            
            // Ø´Ø±ÙˆØ¹ Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±
            await loadMarketData();
            updateInterval = setInterval(loadMarketData, 30000);
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ
            await loadGlobalMarketData();
            
            // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§ÙˆÙ„ÛŒÙ‡
            calculateTrade();
            
            // ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„
            setupModuleControls();
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ¶Ø¹ÛŒØª APIÙ‡Ø§
            loadAPIStatus();
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø®Ø¨Ø§Ø± ÙˆØ§Ù‚Ø¹ÛŒ
            await loadRealNewsData();
        }

        // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ Ù¾Ø±ÙˆÚ©Ø³ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        const advancedProxy = new AdvancedProxy();

        // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ú†Ù†Ø¯Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ
        const aiAnalysisSteps = [
            {
                id: 1,
                title: "Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±",
                description: "Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù‚ÛŒÙ…ØªØŒ Ø­Ø¬Ù… Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ùˆ Ù†ÙˆØ³Ø§Ù†Ø§Øª",
                duration: "5-10 Ø«Ø§Ù†ÛŒÙ‡"
            },
            {
                id: 2,
                title: "ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ Ù¾ÛŒØ´Ø±ÙØªÙ‡",
                description: "Ø¨Ø±Ø±Ø³ÛŒ 35 Ø§Ù†Ø¯ÛŒÚ©Ø§ØªÙˆØ± ØªÚ©Ù†ÛŒÚ©Ø§Ù„ Ùˆ Ø§Ù„Ú¯ÙˆÙ‡Ø§ÛŒ Ù‚ÛŒÙ…ØªÛŒ",
                duration: "10-15 Ø«Ø§Ù†ÛŒÙ‡"
            },
            {
                id: 3,
                title: "ØªØ­Ù„ÛŒÙ„ Ø¨Ù†ÛŒØ§Ø¯ÛŒ",
                description: "Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø®Ø¨Ø§Ø±ØŒ Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ Ùˆ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ø§Ù‚ØªØµØ§Ø¯ÛŒ",
                duration: "8-12 Ø«Ø§Ù†ÛŒÙ‡"
            },
            {
                id: 4,
                title: "ØªØ­Ù„ÛŒÙ„ Ø³Ù†ØªÛŒÙ…Ù†Øª Ø¨Ø§Ø²Ø§Ø±",
                description: "Ø¨Ø±Ø±Ø³ÛŒ Ø§Ø­Ø³Ø§Ø³Ø§Øª Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±Ø§Ù† Ùˆ Ù†ÙˆØ³Ø§Ù†Ø§Øª Ø±ÙˆØ§Ù†ÛŒ",
                duration: "5-8 Ø«Ø§Ù†ÛŒÙ‡"
            },
            {
                id: 5,
                title: "Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ",
                description: "ØªØ¬Ø²ÛŒÙ‡ Ùˆ ØªØ­Ù„ÛŒÙ„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ø¨Ø§ Ø§Ù„Ú¯ÙˆØ±ÛŒØªÙ…â€ŒÙ‡Ø§ÛŒ ML",
                duration: "12-18 Ø«Ø§Ù†ÛŒÙ‡"
            },
            {
                id: 6,
                title: "ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´ Ù†Ù‡Ø§ÛŒÛŒ",
                description: "ØªÙ‡ÛŒÙ‡ Ú¯Ø²Ø§Ø±Ø´ Ø¬Ø§Ù…Ø¹ Ø¨Ø§ ØªÙˆØµÛŒÙ‡â€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ",
                duration: "5-10 Ø«Ø§Ù†ÛŒÙ‡"
            }
        ];

        // ØªÙˆØ§Ø¨Ø¹ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ù¾Ø±ÙˆÚ©Ø³ÛŒ
        function toggleProxySettings() {
            const proxyToggle = document.getElementById('proxyToggle');
            const proxySettings = document.getElementById('proxySettings');
            const proxyStatus = document.querySelector('.proxy-status');
            
            advancedProxy.toggleProxy(proxyToggle.checked);
            
            if (proxyToggle.checked) {
                proxySettings.classList.add('active');
                proxyStatus.innerHTML = 'ğŸ›¡ï¸ Ù¾Ø±ÙˆÚ©Ø³ÛŒ ÙØ¹Ø§Ù„ - Ø§ØªØµØ§Ù„ Ø§ÛŒÙ…Ù†';
                showNotification('ğŸ›¡ï¸ Ø³ÛŒØ³ØªÙ… Ù¾Ø±ÙˆÚ©Ø³ÛŒ ÙØ¹Ø§Ù„ Ø´Ø¯');
                detectIPLocation();
            } else {
                proxySettings.classList.remove('active');
                proxyStatus.innerHTML = 'ğŸ”“ Ù¾Ø±ÙˆÚ©Ø³ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ - Ø§ØªØµØ§Ù„ Ù…Ø³ØªÙ‚ÛŒÙ…';
                showNotification('ğŸ”“ Ø³ÛŒØ³ØªÙ… Ù¾Ø±ÙˆÚ©Ø³ÛŒ ØºÛŒØ±ÙØ¹Ø§Ù„ Ø´Ø¯');
            }
            
            // ØªØ³Øª Ù…Ø¬Ø¯Ø¯ Ø§ØªØµØ§Ù„ API
            testAPIConnections();
        }

        async function testProxyConnection() {
            const proxyLocation = document.getElementById('proxyLocation').value;
            const testResult = document.getElementById('proxyTestResult');
            
            testResult.innerHTML = '<div class="proxy-test-result">ğŸ”„ Ø¯Ø± Ø­Ø§Ù„ ØªØ³Øª Ø§ØªØµØ§Ù„ Ù¾Ø±ÙˆÚ©Ø³ÛŒ...</div>';
            
            try {
                // ØªØºÛŒÛŒØ± Ù…ÙˆÙ‚Ø¹ÛŒØª Ù¾Ø±ÙˆÚ©Ø³ÛŒ
                advancedProxy.setProxyLocation(proxyLocation);
                
                // ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ø§ ÛŒÚ© Ø¯Ø±Ø®ÙˆØ§Ø³Øª Ø³Ø§Ø¯Ù‡
                const startTime = Date.now();
                const response = await advancedProxy.fetchWithProxy('https://api.coingecko.com/api/v3/ping');
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                if (response.ok) {
                    testResult.innerHTML = `<div class="proxy-test-result proxy-success">
                        âœ… Ø§ØªØµØ§Ù„ Ù…ÙˆÙÙ‚ - Ù¾ÛŒÙ†Ú¯: ${responseTime}ms - Ù…ÙˆÙ‚Ø¹ÛŒØª: ${getLocationName(proxyLocation)}
                    </div>`;
                    showNotification(`âœ… Ù¾Ø±ÙˆÚ©Ø³ÛŒ ${getLocationName(proxyLocation)} Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ù…ØªØµÙ„ Ø´Ø¯`);
                } else {
                    throw new Error('Response not OK');
                }
                
                // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª IP
                detectIPLocation();
                
            } catch (error) {
                testResult.innerHTML = `<div class="proxy-test-result proxy-error">
                    âŒ Ø§ØªØµØ§Ù„ Ù†Ø§Ù…ÙˆÙÙ‚ - Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ù‚Ø±Ø§Ø±ÛŒ Ø§Ø±ØªØ¨Ø§Ø· Ø¨Ø§ Ù¾Ø±ÙˆÚ©Ø³ÛŒ
                </div>`;
                showNotification('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ù¾Ø±ÙˆÚ©Ø³ÛŒ');
            }
        }

        async function detectIPLocation() {
            try {
                const response = await advancedProxy.fetchWithProxy('https://api.ipify.org?format=json');
                const ipData = await response.json();
                document.getElementById('currentIP').textContent = ipData.ip;
                
                // Ø¯Ø±ÛŒØ§ÙØª Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ù…ÙˆÙ‚Ø¹ÛŒØª Ù…Ú©Ø§Ù†ÛŒ
                const locationResponse = await advancedProxy.fetchWithProxy(`https://ipapi.co/${ipData.ip}/json/`);
                const locationData = await locationResponse.json();
                
                document.getElementById('currentLocation').textContent = 
                    `${locationData.country_name} (${locationData.city})`;
                    
            } catch (error) {
                document.getElementById('currentIP').textContent = 'Ù†Ø§Ù…Ø´Ø®Øµ';
                document.getElementById('currentLocation').textContent = 'Ù†Ø§Ù…Ø´Ø®Øµ';
            }
        }

        function getLocationName(location) {
            const names = {
                'germany': 'Ø¢Ù„Ù…Ø§Ù† ğŸ‡©ğŸ‡ª',
                'netherlands': 'Ù‡Ù„Ù†Ø¯ ğŸ‡³ğŸ‡±',
                'usa': 'Ø¢Ù…Ø±ÛŒÚ©Ø§ ğŸ‡ºğŸ‡¸',
                'singapore': 'Ø³Ù†Ú¯Ø§Ù¾ÙˆØ± ğŸ‡¸ğŸ‡¬',
                'turkey': 'ØªØ±Ú©ÛŒÙ‡ ğŸ‡¹ğŸ‡·'
            };
            return names[location] || location;
        }

        // Ø³ÛŒØ³ØªÙ… Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ú†Ù†Ø¯Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        class AdvancedAIAnalysis {
            constructor() {
                this.currentStep = 0;
                this.analysisData = {};
                this.isRunning = false;
            }

            async startAnalysis(symbol, market, timeframe, amount) {
                if (this.isRunning) {
                    throw new Error('ØªØ­Ù„ÛŒÙ„ Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§Ø³Øª');
                }

                this.isRunning = true;
                this.currentStep = 0;
                this.analysisData = {
                    symbol,
                    market,
                    timeframe,
                    amount,
                    startTime: new Date(),
                    steps: []
                };

                // Ø§Ø¬Ø±Ø§ÛŒ Ù…Ø±Ø§Ø­Ù„ ØªØ­Ù„ÛŒÙ„
                for (const step of aiAnalysisSteps) {
                    this.currentStep = step.id;
                    await this.executeStep(step);
                }

                this.isRunning = false;
                return this.generateFinalReport();
            }

            async executeStep(step) {
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ UI
                this.updateStepUI(step);
                
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´
                await this.simulateProcessing(step.duration);
                
                // Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…Ø±Ø­Ù„Ù‡
                const stepResult = await this.collectStepData(step);
                this.analysisData.steps.push(stepResult);
                
                return stepResult;
            }

            updateStepUI(step) {
                // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…Ø±Ø§Ø­Ù„ Ø¯Ø± UI
                const stepsContainer = document.querySelector('.ai-steps');
                if (stepsContainer) {
                    const steps = stepsContainer.querySelectorAll('.ai-step');
                    steps.forEach((stepEl, index) => {
                        stepEl.classList.remove('active', 'completed');
                        if (index + 1 < step.id) {
                            stepEl.classList.add('completed');
                        } else if (index + 1 === step.id) {
                            stepEl.classList.add('active');
                        }
                    });
                }

                // Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª ÙØ¹Ù„ÛŒ
                const statusElement = document.getElementById('aiAnalysisStatus');
                if (statusElement) {
                    statusElement.innerHTML = `
                        <div style="background: #f0f9ff; padding: 15px; border-radius: 10px; margin: 12px 0;">
                            <h4>ğŸ§  Ù…Ø±Ø­Ù„Ù‡ ${step.id}: ${step.title}</h4>
                            <p style="color: #6b7280; margin: 8px 0;">${step.description}</p>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${(step.id / aiAnalysisSteps.length) * 100}%"></div>
                            </div>
                            <div style="margin-top: 8px; font-size: 0.8rem; color: #9ca3af;">
                                Ø²Ù…Ø§Ù† ØªØ®Ù…ÛŒÙ†ÛŒ: ${step.duration}
                            </div>
                        </div>
                    `;
                }
            }

            async simulateProcessing(duration) {
                const timeMatch = duration.match(/(\d+)/);
                const seconds = timeMatch ? parseInt(timeMatch[1]) : 10;
                
                return new Promise(resolve => {
                    setTimeout(resolve, seconds * 1000);
                });
            }

            async collectStepData(step) {
                // Ø¯Ø± Ù…Ø­ÛŒØ· ÙˆØ§Ù‚Ø¹ÛŒØŒ Ø§ÛŒÙ†Ø¬Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ù…ÛŒâ€ŒØ´ÙˆÙ†Ø¯
                // Ø¨Ø±Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ØŒ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ…
                
                const stepData = {
                    stepId: step.id,
                    stepName: step.title,
                    timestamp: new Date(),
                    data: {}
                };

                switch(step.id) {
                    case 1: // Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±
                        stepData.data = await this.collectMarketData();
                        break;
                    case 2: // ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„
                        stepData.data = await this.technicalAnalysis();
                        break;
                    case 3: // ØªØ­Ù„ÛŒÙ„ Ø¨Ù†ÛŒØ§Ø¯ÛŒ
                        stepData.data = await this.fundamentalAnalysis();
                        break;
                    case 4: // ØªØ­Ù„ÛŒÙ„ Ø³Ù†ØªÛŒÙ…Ù†Øª
                        stepData.data = await this.sentimentAnalysis();
                        break;
                    case 5: // Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
                        stepData.data = await this.mlProcessing();
                        break;
                    case 6: // Ú¯Ø²Ø§Ø±Ø´ Ù†Ù‡Ø§ÛŒÛŒ
                        stepData.data = await this.finalAnalysis();
                        break;
                }

                return stepData;
            }

            async collectMarketData() {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±
                return {
                    price: (Math.random() * 100000 + 1000).toFixed(2),
                    volume: (Math.random() * 1000000 + 10000).toFixed(0),
                    volatility: (Math.random() * 10 + 1).toFixed(2),
                    marketCap: (Math.random() * 1000000000 + 1000000).toFixed(0)
                };
            }

            async technicalAnalysis() {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„
                const indicators = ['RSI', 'MACD', 'Bollinger Bands', 'Moving Averages', 'Stochastic'];
                const results = {};
                
                indicators.forEach(indicator => {
                    results[indicator] = {
                        value: (Math.random() * 100).toFixed(2),
                        signal: Math.random() > 0.5 ? 'Ø®Ø±ÛŒØ¯' : 'ÙØ±ÙˆØ´',
                        strength: (Math.random() * 10).toFixed(1)
                    };
                });
                
                return results;
            }

            async fundamentalAnalysis() {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ­Ù„ÛŒÙ„ Ø¨Ù†ÛŒØ§Ø¯ÛŒ
                return {
                    newsScore: (Math.random() * 10).toFixed(1),
                    eventImpact: Math.random() > 0.7 ? 'Ù…Ø«Ø¨Øª' : Math.random() > 0.3 ? 'Ø®Ù†Ø«ÛŒ' : 'Ù…Ù†ÙÛŒ',
                    marketTrend: Math.random() > 0.5 ? 'ØµØ¹ÙˆØ¯ÛŒ' : 'Ù†Ø²ÙˆÙ„ÛŒ'
                };
            }

            async sentimentAnalysis() {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ ØªØ­Ù„ÛŒÙ„ Ø³Ù†ØªÛŒÙ…Ù†Øª
                return {
                    fearGreedIndex: Math.floor(Math.random() * 100),
                    socialSentiment: (Math.random() * 100 - 50).toFixed(1),
                    investorConfidence: (Math.random() * 10).toFixed(1)
                };
            }

            async mlProcessing() {
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
                return {
                    prediction: (Math.random() * 30 + 60).toFixed(1),
                    confidence: (Math.random() * 40 + 60).toFixed(1),
                    riskLevel: Math.random() > 0.7 ? 'Ø¨Ø§Ù„Ø§' : Math.random() > 0.4 ? 'Ù…ØªÙˆØ³Ø·' : 'Ù¾Ø§ÛŒÛŒÙ†'
                };
            }

            async finalAnalysis() {
                // ØªÙˆÙ„ÛŒØ¯ Ú¯Ø²Ø§Ø±Ø´ Ù†Ù‡Ø§ÛŒÛŒ
                const probability = Math.floor(Math.random() * 30 + 65);
                return {
                    finalDecision: probability >= 75 ? 'Ø®Ø±ÛŒØ¯' : probability >= 60 ? 'Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ' : 'ÙØ±ÙˆØ´',
                    probability: probability,
                    confidence: (Math.random() * 30 + 70).toFixed(1),
                    targets: {
                        takeProfit: (Math.random() * 20 + 5).toFixed(1),
                        stopLoss: (Math.random() * 10 + 2).toFixed(1),
                        timeFrame: '1-3 Ø±ÙˆØ²'
                    },
                    riskAssessment: probability >= 80 ? 'Ù¾Ø§ÛŒÛŒÙ†' : probability >= 65 ? 'Ù…ØªÙˆØ³Ø·' : 'Ø¨Ø§Ù„Ø§'
                };
            }

            generateFinalReport() {
                const finalStep = this.analysisData.steps[this.analysisData.steps.length - 1];
                const mlStep = this.analysisData.steps.find(step => step.stepId === 5);
                
                return {
                    symbol: this.analysisData.symbol,
                    market: this.analysisData.market,
                    timeframe: this.analysisData.timeframe,
                    amount: this.analysisData.amount,
                    analysisTime: new Date() - this.analysisData.startTime,
                    decision: finalStep.data.finalDecision,
                    probability: finalStep.data.probability,
                    confidence: finalStep.data.confidence,
                    riskLevel: finalStep.data.riskAssessment,
                    targets: finalStep.data.targets,
                    technicalIndicators: this.analysisData.steps[1].data,
                    sentiment: this.analysisData.steps[3].data,
                    mlPrediction: mlStep.data
                };
            }
        }

        // Ø§ÛŒØ¬Ø§Ø¯ Ù†Ù…ÙˆÙ†Ù‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
        const advancedAI = new AdvancedAIAnalysis();

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        async function runAdvancedAIAnalysis() {
            const symbol = document.getElementById('aiSymbol').value;
            const market = document.getElementById('aiMarket').value;
            const timeframe = document.getElementById('aiTimeframe').value;
            const amount = document.getElementById('aiAmount').value;

            if (!symbol || !market || !timeframe || !amount) {
                alert('Ù„Ø·ÙØ§ ØªÙ…Ø§Ù… ÙÛŒÙ„Ø¯Ù‡Ø§ Ø±Ø§ Ù¾Ø± Ú©Ù†ÛŒØ¯');
                return;
            }

            try {
                const resultsDiv = document.getElementById('aiResults');
                resultsDiv.innerHTML = `
                    <div class="ai-analysis-flow">
                        <h4>ğŸ§  ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa</h4>
                        <div class="ai-steps">
                            ${aiAnalysisSteps.map((step, index) => `
                                <div class="ai-step ${index === 0 ? 'active' : ''}">
                                    ${step.id}
                                    <div class="ai-step-label">${step.title}</div>
                                </div>
                            `).join('')}
                        </div>
                        <div id="aiAnalysisStatus"></div>
                    </div>
                `;

                const result = await advancedAI.startAnalysis(symbol, market, timeframe, amount);
                displayAIAnalysisResults(result);

            } catch (error) {
                console.error('Error in AI analysis:', error);
                showNotification('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§Ø¬Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ');
            }
        }

        function displayAIAnalysisResults(result) {
            const resultsDiv = document.getElementById('aiResults');
            
            resultsDiv.innerHTML = `
                <div class="advanced-results">
                    <h4>ğŸ§  Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa</h4>
                    
                    <div class="final-prediction ${result.decision === 'Ø®Ø±ÛŒØ¯' ? '' : result.decision === 'ÙØ±ÙˆØ´' ? 'danger' : 'warning'}">
                        <div class="prediction-header">
                            <div class="symbol-info">
                                <h3 style="font-size: 1.2rem;">${result.symbol}</h3>
                                <small>${result.market} - ${result.timeframe}</small>
                            </div>
                            <div class="timeframe">â° Ø²Ù…Ø§Ù† ØªØ­Ù„ÛŒÙ„: ${(result.analysisTime / 1000).toFixed(1)} Ø«Ø§Ù†ÛŒÙ‡</div>
                        </div>
                        
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
                            <div class="probability-circle">
                                <div class="circle-value">${result.probability}%</div>
                                <div class="circle-label">Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª</div>
                            </div>
                            
                            <div class="decision">
                                <div class="decision-text">${result.decision}</div>
                                <div class="decision-subtext">Ø³Ø·Ø­ Ø§Ø·Ù…ÛŒÙ†Ø§Ù†: ${result.confidence}%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="trading-targets-grid">
                        <div class="target-card profit">
                            <div class="target-icon">ğŸ¯</div>
                            <div class="target-label">Ø­Ø¯ Ø³ÙˆØ¯</div>
                            <div class="target-value">${result.targets.takeProfit}%</div>
                        </div>
                        
                        <div class="target-card loss">
                            <div class="target-icon">ğŸ›¡ï¸</div>
                            <div class="target-label">Ø­Ø¯ Ø¶Ø±Ø±</div>
                            <div class="target-value">${result.targets.stopLoss}%</div>
                        </div>
                        
                        <div class="target-card time">
                            <div class="target-icon">â±ï¸</div>
                            <div class="target-label">Ø²Ù…Ø§Ù† Ø¨Ø§Ø²Ø¯Ù‡ÛŒ</div>
                            <div class="target-value">${result.targets.timeFrame}</div>
                        </div>
                        
                        <div class="target-card risk">
                            <div class="target-icon">ğŸ“Š</div>
                            <div class="target-label">Ø³Ø·Ø­ Ø±ÛŒØ³Ú©</div>
                            <div class="target-value" style="color: ${result.riskLevel === 'Ø¨Ø§Ù„Ø§' ? '#ef4444' : result.riskLevel === 'Ù…ØªÙˆØ³Ø·' ? '#f59e0b' : '#10b981'}">
                                ${result.riskLevel}
                            </div>
                        </div>
                    </div>
                    
                    <div style="margin-top: 20px;">
                        <h5>ğŸ“ˆ Ø¬Ø²Ø¦ÛŒØ§Øª ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„</h5>
                        <div class="analysis-grid">
                            ${Object.entries(result.technicalIndicators).map(([key, value]) => `
                                <div class="analysis-card">
                                    <div class="target-label">${key}</div>
                                    <div class="analysis-score ${value.signal === 'Ø®Ø±ÛŒØ¯' ? 'good' : value.signal === 'ÙØ±ÙˆØ´' ? 'poor' : 'average'}">
                                        ${value.value}
                                    </div>
                                    <div style="font-size: 0.8rem; color: #6b7280;">
                                        Ø³ÛŒÚ¯Ù†Ø§Ù„: ${value.signal}
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
                
                <div class="form-actions" style="margin-top: 20px;">
                    <button class="btn" onclick="saveAIAnalysis()" style="background: #10b981;">
                        ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªØ­Ù„ÛŒÙ„
                    </button>
                    <button class="btn" onclick="exportAIAnalysis()" style="background: #3b82f6;">
                        ğŸ“¤ Ø®Ø±ÙˆØ¬ÛŒ PDF
                    </button>
                    <button class="btn" onclick="runNewAIAnalysis()" style="background: #f59e0b;">
                        ğŸ”„ ØªØ­Ù„ÛŒÙ„ Ø¬Ø¯ÛŒØ¯
                    </button>
                </div>
            `;
        }

        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
        function saveAIAnalysis() {
            showNotification('âœ… ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
        }

        function exportAIAnalysis() {
            showNotification('ğŸ“¤ Ø¯Ø± Ø­Ø§Ù„ ØªÙˆÙ„ÛŒØ¯ Ø®Ø±ÙˆØ¬ÛŒ PDF...');
        }

        function runNewAIAnalysis() {
            document.getElementById('aiResults').innerHTML = '';
            showNotification('ğŸ”„ ØªØ­Ù„ÛŒÙ„ Ø¬Ø¯ÛŒØ¯ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª');
        }

        // Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ø¨Ø±Ù†Ø§Ù…Ù‡ - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡
        async function initializeApp() {
            updateTime();
            setInterval(updateTime, 1000);
            
            // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ù¾Ø±ÙˆÚ©Ø³ÛŒ
            await initializeProxySystem();
            
            // Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ IP Ùˆ Ù…ÙˆÙ‚Ø¹ÛŒØª
            await detectIPLocation();
            
            // ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ APIÙ‡Ø§
            await testAPIConnections();
            
            // Ø¨Ù‚ÛŒÙ‡ Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒâ€ŒÙ‡Ø§...
        }

        // ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ APIÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù - Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡
        async function testAPIConnections() {
            const statusIndicator = document.querySelector('.api-status');
            const realTimeIndicator = document.querySelector('.real-time-indicator');
            
            try {
                // ØªØ³Øª CoinGecko
                const coingeckoTest = await advancedProxy.fetchWithProxy(`${API_CONFIG.COINGECKO}/ping`);
                if (!coingeckoTest.ok) throw new Error('CoinGecko API Error');
                
                // ØªØ³Øª Binance
                const binanceTest = await advancedProxy.fetchWithProxy(`${API_CONFIG.BINANCE}/ping`);
                if (!binanceTest.ok) throw new Error('Binance API Error');
                
                // ØªØ³Øª Alpha Vantage
                const alphaTest = await advancedProxy.fetchWithProxy(`${API_CONFIG.ALPHA_VANTAGE}?function=GLOBAL_QUOTE&symbol=IBM&apikey=demo`);
                if (!alphaTest.ok) throw new Error('Alpha Vantage API Error');
                
                // ØªØ³Øª XChief
                await testXChiefConnection();
                
                // ØªØ³Øª Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
                await testMofidConnection();
                
                isOnline = true;
                statusIndicator.textContent = 'LIVE';
                statusIndicator.className = 'api-status api-live';
                realTimeIndicator.style.background = '#10b981';
                
                showNotification('âœ… ØªÙ…Ø§Ù… Ø§ØªØµØ§Ù„Ø§Øª API Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯');
                
            } catch (error) {
                console.error('API Connection Error:', error);
                isOnline = false;
                statusIndicator.textContent = 'OFFLINE';
                statusIndicator.className = 'api-status api-offline';
                realTimeIndicator.style.background = '#ef4444';
                
                showNotification('âš ï¸ Ø¨Ø±Ø®ÛŒ Ø§ØªØµØ§Ù„Ø§Øª API Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†ÛŒØ³Øª. Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.');
            }
        }

        // ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ XChief
        async function testXChiefConnection() {
            try {
                // Ø§ÛŒÙ† ÛŒÚ© ØªØ³Øª Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³Øª - Ø¯Ø± Ù…Ø­ÛŒØ· ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ API ÙˆØ§Ù‚Ø¹ÛŒ XChief Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø´ÙˆØ¯
                const response = await advancedProxy.fetchWithProxy(`${API_CONFIG.XCHIEF}/status`);
                xchiefConnected = response.ok;
                
                if (xchiefConnected) {
                    showNotification('âœ… Ø§ØªØµØ§Ù„ Ø¨Ù‡ ØµØ±Ø§ÙÛŒ XChief Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯');
                }
            } catch (error) {
                console.log('XChief connection failed, using simulated data');
                xchiefConnected = false;
            }
        }

        // ØªØ³Øª Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
        async function testMofidConnection() {
            try {
                // Ø§ÛŒÙ† ÛŒÚ© ØªØ³Øª Ù†Ù…ÙˆÙ†Ù‡ Ø§Ø³Øª - Ø¯Ø± Ù…Ø­ÛŒØ· ÙˆØ§Ù‚Ø¹ÛŒ Ø¨Ø§ÛŒØ¯ Ø¨Ø§ API ÙˆØ§Ù‚Ø¹ÛŒ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯ Ø¬Ø§ÛŒÚ¯Ø²ÛŒÙ† Ø´ÙˆØ¯
                const response = await advancedProxy.fetchWithProxy(`${API_CONFIG.MOFID}/status`);
                mofidConnected = response.ok;
                
                if (mofidConnected) {
                    showNotification('âœ… Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯ Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯');
                }
            } catch (error) {
                console.log('Mofid connection failed, using simulated data');
                mofidConnected = false;
            }
        }

        // Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù†Ø¨Ø¹ Ø¯Ø§Ø¯Ù‡
        function selectDataSource(source) {
            currentDataSource = source;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¸Ø§Ù‡Ø±
            document.querySelectorAll('.source-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.closest('.source-option').classList.add('active');
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ ØµØ±Ø§ÙÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
            loadExchangeSymbols(source);
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
            loadMarketData();
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ ØµØ±Ø§ÙÛŒ
        async function loadExchangeSymbols(exchange) {
            console.log('Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ ØµØ±Ø§ÙÛŒ:', exchange);
            
            const symbolSelects = [
                document.getElementById('analysisSymbol'),
                document.getElementById('calcSymbol'),
                document.getElementById('symbolSelect')
            ];
            
            // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú¯Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¨Ù„ÛŒ
            symbolSelects.forEach(select => {
                if (select) {
                    select.innerHTML = '<option value="">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§...</option>';
                }
            });
            
            try {
                let symbols = [];
                
                switch(exchange) {
                    case 'binance':
                        symbols = await loadBinanceSymbols();
                        break;
                    case 'xchief':
                        symbols = await loadXChiefSymbols();
                        break;
                    case 'coingecko':
                        symbols = await loadCoinGeckoSymbols();
                        break;
                    case 'alphavantage':
                        symbols = await loadAlphaVantageSymbols();
                        break;
                    case 'tsetmc':
                        symbols = await loadTSETMCSymbols();
                        break;
                    case 'mofid':
                        symbols = await loadMofidSymbols();
                        break;
                    case 'multiple':
                        symbols = await loadMultipleSourcesSymbols();
                        break;
                    default:
                        symbols = getDefaultSymbols();
                }
                
                // Ù¾Ø± Ú©Ø±Ø¯Ù† selectÙ‡Ø§
                symbolSelects.forEach(select => {
                    if (select) {
                        select.innerHTML = '<option value="">Ù„Ø·ÙØ§ Ù†Ù…Ø§Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>';
                        symbols.forEach(symbol => {
                            const option = document.createElement('option');
                            option.value = symbol.id;
                            option.textContent = symbol.name + (symbol.symbol ? ` (${symbol.symbol})` : '');
                            select.appendChild(option);
                        });
                    }
                });
                
                showNotification(`âœ… Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ ${exchange} Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯`);
                
            } catch (error) {
                console.error('Error loading symbols:', error);
                loadDefaultSymbols();
                showNotification('âš ï¸ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§. Ø§Ø² Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.');
            }
        }

        // Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Binance
        async function loadBinanceSymbols() {
            try {
                const response = await fetch('https://api.binance.com/api/v3/exchangeInfo');
                const data = await response.json();
                
                return data.symbols
                    .filter(s => s.status === 'TRADING' && s.symbol.endsWith('USDT'))
                    .slice(0, 20)
                    .map(s => ({
                        id: s.symbol.toLowerCase().replace('usdt', ''),
                        name: s.baseAsset,
                        symbol: s.symbol
                    }));
            } catch (error) {
                return getDefaultCryptoSymbols();
            }
        }

        // Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ CoinGecko
        async function loadCoinGeckoSymbols() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&order=market_cap_desc&per_page=20&page=1');
                const data = await response.json();
                
                return data.map(coin => ({
                    id: coin.id,
                    name: coin.name,
                    symbol: coin.symbol.toUpperCase()
                }));
            } catch (error) {
                return getDefaultCryptoSymbols();
            }
        }

        // Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Alpha Vantage
        async function loadAlphaVantageSymbols() {
            return [
                { id: 'AAPL', name: 'Ø§Ù¾Ù„', symbol: 'AAPL' },
                { id: 'MSFT', name: 'Ù…Ø§ÛŒÚ©Ø±ÙˆØ³Ø§ÙØª', symbol: 'MSFT' },
                { id: 'GOOGL', name: 'Ú¯ÙˆÚ¯Ù„', symbol: 'GOOGL' },
                { id: 'AMZN', name: 'Ø¢Ù…Ø§Ø²ÙˆÙ†', symbol: 'AMZN' },
                { id: 'TSLA', name: 'ØªØ³Ù„Ø§', symbol: 'TSLA' },
                { id: 'EUR/USD', name: 'ÛŒÙˆØ±Ùˆ/Ø¯Ù„Ø§Ø±', symbol: 'EURUSD' },
                { id: 'GBP/USD', name: 'Ù¾ÙˆÙ†Ø¯/Ø¯Ù„Ø§Ø±', symbol: 'GBPUSD' }
            ];
        }

        // Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ TSETMC
        async function loadTSETMCSymbols() {
            return [
                { id: 'Ø´Ø§Ø®Øµ Ú©Ù„', name: 'Ø´Ø§Ø®Øµ Ú©Ù„ Ø¨ÙˆØ±Ø³' },
                { id: 'ÙÙ…Ù„ÛŒ', name: 'ÙÙˆÙ„Ø§Ø¯ Ù…Ø¨Ø§Ø±Ú©Ù‡' },
                { id: 'ÙÙˆÙ„Ø§Ø¯', name: 'ÙÙˆÙ„Ø§Ø¯ Ø®ÙˆØ²Ø³ØªØ§Ù†' },
                { id: 'Ú©Ú¯Ù„', name: 'Ú©Ú¯Ù„' },
                { id: 'ÙˆØ¨ØµØ§Ø¯Ø±', name: 'ÙˆØ¨ØµØ§Ø¯Ø±' }
            ];
        }

        // Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ XChief
        async function loadXChiefSymbols() {
            if (!xchiefConnected) {
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ XChief
                return [
                    { id: 'xcf_usdt', name: 'XCHIEF Token', symbol: 'XCF/USDT' },
                    { id: 'btc_usdt', name: 'Bitcoin', symbol: 'BTC/USDT' },
                    { id: 'eth_usdt', name: 'Ethereum', symbol: 'ETH/USDT' },
                    { id: 'xcf_btc', name: 'XCHIEF Token', symbol: 'XCF/BTC' },
                    { id: 'xcf_eth', name: 'XCHIEF Token', symbol: 'XCF/ETH' }
                ];
            }
            
            try {
                const response = await advancedProxy.fetchWithProxy(`${API_CONFIG.XCHIEF}/markets`);
                const data = await response.json();
                
                return data.markets.map(market => ({
                    id: market.symbol.toLowerCase(),
                    name: market.baseAsset,
                    symbol: market.symbol
                }));
            } catch (error) {
                return getDefaultCryptoSymbols();
            }
        }

        // Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
        async function loadMofidSymbols() {
            if (!mofidConnected) {
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
                return [
                    { id: 'ÙÙ…Ù„ÛŒ', name: 'ÙÙˆÙ„Ø§Ø¯ Ù…Ø¨Ø§Ø±Ú©Ù‡ Ø§ØµÙÙ‡Ø§Ù†', symbol: 'ÙÙ…Ù„ÛŒ' },
                    { id: 'ÙÙˆÙ„Ø§Ø¯', name: 'ÙÙˆÙ„Ø§Ø¯ Ø®ÙˆØ²Ø³ØªØ§Ù†', symbol: 'ÙÙˆÙ„Ø§Ø¯' },
                    { id: 'Ú©Ú¯Ù„', name: 'Ú©Ú¯Ù„', symbol: 'Ú©Ú¯Ù„' },
                    { id: 'ÙˆØ¨ØµØ§Ø¯Ø±', name: 'ÙˆØ¨ØµØ§Ø¯Ø±', symbol: 'ÙˆØ¨ØµØ§Ø¯Ø±' },
                    { id: 'Ø´Ù¾Ù†Ø§', name: 'Ø´Ù¾Ù†Ø§', symbol: 'Ø´Ù¾Ù†Ø§' },
                    { id: 'Ø®Ø³Ø§Ù¾Ø§', name: 'Ø®Ø³Ø§Ù¾Ø§', symbol: 'Ø®Ø³Ø§Ù¾Ø§' },
                    { id: 'Ø´ØªØ±Ø§Ù†', name: 'Ø´ØªØ±Ø§Ù†', symbol: 'Ø´ØªØ±Ø§Ù†' },
                    { id: 'ÙˆØ¨Ù…Ù„Øª', name: 'ÙˆØ¨Ù…Ù„Øª', symbol: 'ÙˆØ¨Ù…Ù„Øª' }
                ];
            }
            
            try {
                const response = await advancedProxy.fetchWithProxy(`${API_CONFIG.MOFID}/symbols`);
                const data = await response.json();
                
                return data.symbols.map(symbol => ({
                    id: symbol.id,
                    name: symbol.name,
                    symbol: symbol.symbol
                }));
            } catch (error) {
                return getDefaultTehranSymbols();
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø² Ú†Ù†Ø¯ÛŒÙ† Ù…Ù†Ø¨Ø¹
        async function loadMultipleSourcesSymbols() {
            const [binanceSymbols, coingeckoSymbols, xchiefSymbols, mofidSymbols] = await Promise.all([
                loadBinanceSymbols().catch(() => []),
                loadCoinGeckoSymbols().catch(() => []),
                loadXChiefSymbols().catch(() => []),
                loadMofidSymbols().catch(() => [])
            ]);
            
            // ØªØ±Ú©ÛŒØ¨ Ùˆ Ø­Ø°Ù Ù…ÙˆØ§Ø±Ø¯ ØªÚ©Ø±Ø§Ø±ÛŒ
            const allSymbols = [...binanceSymbols, ...coingeckoSymbols, ...xchiefSymbols, ...mofidSymbols];
            const uniqueSymbols = allSymbols.filter((symbol, index, self) =>
                index === self.findIndex(s => s.id === symbol.id)
            );
            
            return uniqueSymbols.slice(0, 30); // Ù…Ø­Ø¯ÙˆØ¯ÛŒØª Û³Û° Ù†Ù…Ø§Ø¯
        }

        // Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
        function getDefaultCryptoSymbols() {
            return [
                { id: 'bitcoin', name: 'Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ†', symbol: 'BTC' },
                { id: 'ethereum', name: 'Ø§ØªØ±ÛŒÙˆÙ…', symbol: 'ETH' },
                { id: 'binancecoin', name: 'Ø¨Ø§ÛŒÙ†Ù†Ø³ Ú©ÙˆÛŒÙ†', symbol: 'BNB' },
                { id: 'ripple', name: 'Ø±ÛŒÙ¾Ù„', symbol: 'XRP' },
                { id: 'cardano', name: 'Ú©Ø§Ø±Ø¯Ø§Ù†Ùˆ', symbol: 'ADA' },
                { id: 'solana', name: 'Ø³ÙˆÙ„Ø§Ù†Ø§', symbol: 'SOL' },
                { id: 'polkadot', name: 'Ù¾ÙˆÙ„Ú©Ø§Ø¯Ø§Øª', symbol: 'DOT' },
                { id: 'dogecoin', name: 'Ø¯ÙˆØ¬ Ú©ÙˆÛŒÙ†', symbol: 'DOGE' }
            ];
        }

        function getDefaultTehranSymbols() {
            return [
                { id: 'ÙÙ…Ù„ÛŒ', name: 'ÙÙˆÙ„Ø§Ø¯ Ù…Ø¨Ø§Ø±Ú©Ù‡ Ø§ØµÙÙ‡Ø§Ù†', symbol: 'ÙÙ…Ù„ÛŒ' },
                { id: 'ÙÙˆÙ„Ø§Ø¯', name: 'ÙÙˆÙ„Ø§Ø¯ Ø®ÙˆØ²Ø³ØªØ§Ù†', symbol: 'ÙÙˆÙ„Ø§Ø¯' },
                { id: 'Ú©Ú¯Ù„', name: 'Ú©Ú¯Ù„', symbol: 'Ú©Ú¯Ù„' },
                { id: 'ÙˆØ¨ØµØ§Ø¯Ø±', name: 'ÙˆØ¨ØµØ§Ø¯Ø±', symbol: 'ÙˆØ¨ØµØ§Ø¯Ø±' }
            ];
        }

        function loadDefaultSymbols() {
            const symbolSelects = [
                document.getElementById('analysisSymbol'),
                document.getElementById('calcSymbol'),
                document.getElementById('symbolSelect')
            ];
            
            const defaultSymbols = getDefaultCryptoSymbols();
            
            symbolSelects.forEach(select => {
                if (select) {
                    select.innerHTML = '<option value="">Ù„Ø·ÙØ§ Ù†Ù…Ø§Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>';
                    defaultSymbols.forEach(symbol => {
                        const option = document.createElement('option');
                        option.value = symbol.id;
                        option.textContent = symbol.name + (symbol.symbol ? ` (${symbol.symbol})` : '');
                        select.appendChild(option);
                    });
                }
            });
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ù‡Ø§Ù†ÛŒ
        async function loadGlobalMarketData() {
            try {
                // Ù…Ø§Ø±Ú©Øªâ€ŒÚ©Ù¾ Ú©Ù„
                const marketCapResponse = await advancedProxy.fetchWithProxy(
                    `${API_CONFIG.COINGECKO}/global`
                );
                const marketData = await marketCapResponse.json();
                
                document.getElementById('totalMarketCap').textContent = 
                    `$${(marketData.data.total_market_cap.usd / 1e12).toFixed(1)}T`;
                
                document.getElementById('btcDominance').textContent = 
                    `${marketData.data.market_cap_percentage.btc.toFixed(1)}%`;
                
                // Ø¨Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯ÙˆØ±Ù‡â€ŒØ§ÛŒ
                setInterval(loadGlobalMarketData, 60000); // Ù‡Ø± 1 Ø¯Ù‚ÛŒÙ‚Ù‡
                
            } catch (error) {
                console.log('Using simulated global market data');
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
                document.getElementById('totalMarketCap').textContent = '$2.1T';
                document.getElementById('btcDominance').textContent = '48.5%';
                document.getElementById('tehranIndex').textContent = '2.1M';
                document.getElementById('goldPrice').textContent = '$1,985';
                document.getElementById('eurusdRate').textContent = '1.0925';
            }
        }

        // Ø§ØªØµØ§Ù„ Ø¨Ù‡ XChief
        async function connectXChief() {
            try {
                showNotification('ğŸ”— Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ ØµØ±Ø§ÙÛŒ XChief...');
                
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§ØªØµØ§Ù„
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                xchiefConnected = true;
                document.getElementById('xchiefAccountInfo').style.display = 'block';
                document.getElementById('xchiefBalance').textContent = '$1,250';
                document.getElementById('xchiefPnL').textContent = '+$45';
                document.getElementById('xchiefTrades').textContent = '8';
                
                showNotification('âœ… Ø§ØªØµØ§Ù„ Ø¨Ù‡ XChief Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯');
                
            } catch (error) {
                showNotification('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ XChief');
            }
        }

        // Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
        async function connectMofid() {
            try {
                showNotification('ğŸ”— Ø¯Ø± Ø­Ø§Ù„ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯...');
                
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§ØªØµØ§Ù„
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                mofidConnected = true;
                document.getElementById('mofidAccountInfo').style.display = 'block';
                document.getElementById('mofidBalance').textContent = '15,000,000 Ø±ÛŒØ§Ù„';
                document.getElementById('mofidPnL').textContent = '+1,200,000 Ø±ÛŒØ§Ù„';
                document.getElementById('mofidTrades').textContent = '5';
                
                // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù¾Ø±ØªØ±Ø§Ú©Ù†Ø´
                loadMofidHotSymbols();
                
                showNotification('âœ… Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø¨Ø±Ù‚Ø±Ø§Ø± Ø´Ø¯');
                
            } catch (error) {
                showNotification('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯');
            }
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ù†Ù…Ø§Ø¯Ù‡Ø§ÛŒ Ù¾Ø±ØªØ±Ø§Ú©Ù†Ø´ Ù…ÙÛŒØ¯
        function loadMofidHotSymbols() {
            const hotSymbols = [
                { name: 'ÙÙ…Ù„ÛŒ', price: '45000', change: '+1.2%' },
                { name: 'ÙÙˆÙ„Ø§Ø¯', price: '38000', change: '+2.1%' },
                { name: 'Ú©Ú¯Ù„', price: '12000', change: '-0.5%' },
                { name: 'ÙˆØ¨ØµØ§Ø¯Ø±', price: '28000', change: '+3.2%' }
            ];
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px;">';
            
            hotSymbols.forEach(symbol => {
                const changeClass = symbol.change.startsWith('+') ? 'positive' : 'negative';
                html += `
                    <div class="price-card">
                        <h4>${symbol.name}</h4>
                        <div class="current-price">${symbol.price}</div>
                        <div class="price-change ${changeClass}">${symbol.change}</div>
                    </div>
                `;
            });
            
            html += '</div>';
            document.getElementById('mofidHotSymbols').innerHTML = html;
        }

        // Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¨Ø§Ø²Ø§Ø±Ù‡Ø§ÛŒ XChief
        function showXChiefMarkets() {
            selectDataSource('xchief');
            showTab('tab-market');
        }

        // Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¨Ø§Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù…ÙÛŒØ¯
        function showMofidMarkets() {
            selectDataSource('mofid');
            showTab('tab-market');
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø±Ø§Ø­Ù„ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        function onMarketChange() {
            const market = document.getElementById('analysisMarket').value;
            userSelections.market = market;
            
            // Ù¾Ø± Ú©Ø±Ø¯Ù† Ù†Ù…Ø§Ø¯Ù‡Ø§ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¨Ø§Ø²Ø§Ø± Ø§Ù†ØªØ®Ø§Ø¨ Ø´Ø¯Ù‡
            const symbolSelect = document.getElementById('analysisSymbol');
            symbolSelect.innerHTML = '<option value="">-- Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§Ø¯ --</option>';
            
            if (symbolsData[market]) {
                symbolsData[market].forEach(symbol => {
                    const option = document.createElement('option');
                    option.value = symbol;
                    option.textContent = symbol;
                    symbolSelect.appendChild(option);
                });
            }
            
            updateAnalysisSteps();
        }

        function updateAnalysisSteps() {
            const steps = document.querySelectorAll('.step');
            steps.forEach((step, index) => {
                step.classList.remove('active', 'completed');
                if (index + 1 < currentAnalysisStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentAnalysisStep) {
                    step.classList.add('active');
                }
            });
        }

        function nextAnalysisStep(step) {
            if (validateAnalysisStep(step)) {
                document.querySelectorAll('.form-step').forEach(stepEl => {
                    stepEl.classList.remove('active');
                });
                
                currentAnalysisStep = step + 1;
                document.getElementById(`analysisStep${currentAnalysisStep}`).classList.add('active');
                updateAnalysisSteps();
            }
        }

        function prevAnalysisStep(step) {
            document.querySelectorAll('.form-step').forEach(stepEl => {
                stepEl.classList.remove('active');
            });
            
            currentAnalysisStep = step - 1;
            document.getElementById(`analysisStep${currentAnalysisStep}`).classList.add('active');
            updateAnalysisSteps();
        }

        // ØªÙˆØ§Ø¨Ø¹ Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª ØªØ­Ù„ÛŒÙ„
        function saveAnalysisToStorage() {
            const analysisData = {
                timestamp: new Date().toLocaleString('fa-IR'),
                market: userSelections.market,
                symbol: document.getElementById('analysisSymbol').value,
                amount: document.getElementById('analysisAmount').value,
                leverage: document.getElementById('analysisLeverage').value,
                results: document.getElementById('resultsContent').innerHTML
            };
            
            const savedAnalyses = JSON.parse(localStorage.getItem('advancedAnalyses') || '[]');
            savedAnalyses.unshift(analysisData);
            localStorage.setItem('advancedAnalyses', JSON.stringify(savedAnalyses.slice(0, 50)));
            
            showNotification('âœ… ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
        }

        function resetToMarketSelection() {
            currentAnalysisStep = 1;
            document.querySelectorAll('.form-step').forEach(stepEl => {
                stepEl.classList.remove('active');
            });
            document.getElementById('analysisStep1').classList.add('active');
            document.getElementById('analysisResults').style.display = 'none';
            updateAnalysisSteps();
            showNotification('ğŸ  Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ø¨Ø§Ø²Ø§Ø±');
        }

        function startNewAnalysis() {
            resetToMarketSelection();
            // Ø±ÛŒØ³Øª Ú©Ø±Ø¯Ù† ÙØ±Ù…
            document.getElementById('analysisMarket').value = '';
            document.getElementById('analysisSymbol').innerHTML = '<option value="">-- Ø§Ù†ØªØ®Ø§Ø¨ Ù†Ù…Ø§Ø¯ --</option>';
            document.getElementById('analysisAmount').value = '1000';
            document.getElementById('analysisLeverage').value = '1';
            userSelections = {};
            showNotification('ğŸ”„ ØªØ­Ù„ÛŒÙ„ Ø¬Ø¯ÛŒØ¯ Ø´Ø±ÙˆØ¹ Ø´Ø¯');
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ÙˆØ¶Ø¹ÛŒØª APIÙ‡Ø§
        function loadAPIStatus() {
            const apiConnections = [
                { name: 'CoinGecko API', status: isOnline ? 'online' : 'offline' },
                { name: 'Binance API', status: isOnline ? 'online' : 'offline' },
                { name: 'XChief API', status: xchiefConnected ? 'online' : 'offline' },
                { name: 'Alpha Vantage API', status: isOnline ? 'online' : 'offline' },
                { name: 'Mofid API', status: mofidConnected ? 'online' : 'offline' },
                { name: 'News API', status: isOnline ? 'online' : 'offline' }
            ];

            let html = '';
            apiConnections.forEach(api => {
                html += `
                    <div class="api-connection">
                        <div class="connection-details">
                            <div class="connection-status-dot ${api.status}"></div>
                            <span>${api.name}</span>
                        </div>
                        <span class="module-status ${api.status === 'online' ? '' : 'status-offline'}">
                            ${api.status === 'online' ? 'Ø¢Ù†Ù„Ø§ÛŒÙ†' : 'Ø¢ÙÙ„Ø§ÛŒÙ†'}
                        </span>
                    </div>
                `;
            });

            document.getElementById('apiConnections').innerHTML = html;
        }

        // ØªÙ†Ø¸ÛŒÙ… Ú©Ù†ØªØ±Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ø§Ú˜ÙˆÙ„
        function setupModuleControls() {
            const toggles = [
                'toggleEnhancedAI', 'toggleReuters', 'toggleBBC',
                'toggleVolumeAnalysis', 'toggleTechnical', 'toggleSentiment'
            ];
            
            toggles.forEach(toggleId => {
                const toggleElement = document.getElementById(toggleId);
                if (toggleElement) {
                    toggleElement.addEventListener('change', function() {
                        const status = this.checked ? 'ÙØ¹Ø§Ù„' : 'ØºÛŒØ±ÙØ¹Ø§Ù„';
                        const moduleName = this.parentElement.previousElementSibling.textContent;
                        showNotification(`Ù…Ø§Ú˜ÙˆÙ„ ${moduleName} ${status} Ø´Ø¯`);
                    });
                }
            });
        }

        // Ù†Ù…Ø§ÛŒØ´ ØªØ¨ Ù‡Ø§
        function showTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.menu-item').forEach(item => {
                item.classList.remove('active');
            });
            
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
            
            // Ø§Ú¯Ø± ØªØ¨ Ø¨Ø§Ø²Ø§Ø± Ø§Ø³ØªØŒ Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ Ø±Ø§ Ø¨Ù‡ Ø±ÙˆØ² Ú©Ù†
            if (tabId === 'tab-market') {
                loadMarketData();
            } else if (tabId === 'tab-news') {
                loadNewsData();
            } else if (tabId === 'tab-saved-analyses') {
                loadSavedAnalyses();
            } else if (tabId === 'tab-xchief') {
                if (!xchiefConnected) {
                    showNotification('ğŸ’ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ XChief Ø§Ø¨ØªØ¯Ø§ Ø§ØªØµØ§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø± Ú©Ù†ÛŒØ¯');
                }
            } else if (tabId === 'tab-mofid') {
                if (!mofidConnected) {
                    showNotification('ğŸ¦ Ø¨Ø±Ø§ÛŒ Ø¯Ø³ØªØ±Ø³ÛŒ Ø¨Ù‡ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯ Ø§Ø¨ØªØ¯Ø§ Ø§ØªØµØ§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø± Ú©Ù†ÛŒØ¯');
                }
            }
            
            // Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ØŒ Ù¾Ø³ Ø§Ø² Ø§Ù†ØªØ®Ø§Ø¨ ØªØ¨ Ù…Ù†Ùˆ Ø±Ø§ Ø¨Ø¨Ù†Ø¯
            if (window.innerWidth <= 768) {
                toggleSidebar();
            }
        }

        // Ø®Ø±ÙˆØ¬
        function logout() {
            document.getElementById('loginPage').style.display = 'block';
            document.getElementById('mainApp').style.display = 'none';
            clearInterval(updateInterval);
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
        function showNotification(message) {
            // Ø§ÛŒØ¬Ø§Ø¯ ÛŒÚ© Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† Ù…ÙˆÙ‚Øª
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #10b981;
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                z-index: 1000;
                box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø²Ù…Ø§Ù†
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleTimeString('fa-IR');
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString('fa-IR');
        }

        // Ø§Ù†ØªØ®Ø§Ø¨ Ù…Ù†Ø¨Ø¹ Ø§Ø®Ø¨Ø§Ø±
        function selectNewsSource(source) {
            currentNewsSource = source;
            
            // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¸Ø§Ù‡Ø±
            document.querySelectorAll('.source-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.closest('.source-option').classList.add('active');
            
            // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø®Ø¨Ø§Ø± Ø¬Ø¯ÛŒØ¯
            loadNewsData();
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø®Ø¨Ø§Ø±
        async function loadNewsData() {
            await loadRealNewsData();
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø®Ø¨Ø§Ø± ÙˆØ§Ù‚Ø¹ÛŒ
        async function loadRealNewsData() {
            try {
                const newsLoading = document.getElementById('newsLoading');
                const newsData = document.getElementById('newsData');
                
                newsLoading.style.display = 'block';
                newsData.style.display = 'none';
                
                // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§Ø®Ø¨Ø§Ø±
                setTimeout(() => {
                    const sampleNews = [
                        {
                            title: 'Ø¨Ø§Ø²Ø§Ø± Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø¨Ø§ Ø±Ø´Ø¯ Ù…Ø«Ø¨Øª Ø±ÙˆØ¨Ø±Ùˆ Ø´Ø¯',
                            description: 'Ù‚ÛŒÙ…Øª Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ† Ùˆ Ø§ØªØ±ÛŒÙˆÙ… Ø¯Ø± Û²Û´ Ø³Ø§Ø¹Øª Ú¯Ø°Ø´ØªÙ‡ Ø±Ø´Ø¯ Ù‚Ø§Ø¨Ù„ ØªÙˆØ¬Ù‡ÛŒ Ø±Ø§ ØªØ¬Ø±Ø¨Ù‡ Ú©Ø±Ø¯Ù†Ø¯.',
                            source: 'Mousa Trading',
                            time: 'Ù‡Ù… Ø§Ú©Ù†ÙˆÙ†',
                            url: '#'
                        },
                        {
                            title: 'ØªØ­Ù„ÛŒÙ„â€ŒÚ¯Ø±Ø§Ù† Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø±Ø´Ø¯ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³Ù‡Ø§Ù…',
                            description: 'Ú©Ø§Ø±Ø´Ù†Ø§Ø³Ø§Ù† Ù…Ø¹ØªÙ‚Ø¯Ù†Ø¯ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ Ø¨ÙˆØ±Ø³ Ø¯Ø± Ù‡ÙØªÙ‡ Ø¢ÛŒÙ†Ø¯Ù‡ Ø±ÙˆÙ†Ø¯ ØµØ¹ÙˆØ¯ÛŒ Ø®ÙˆØ§Ù‡Ù†Ø¯ Ø¯Ø§Ø´Øª.',
                            source: 'Mousa Trading',
                            time: 'Û± Ø³Ø§Ø¹Øª Ù¾ÛŒØ´',
                            url: '#'
                        }
                    ];
                    
                    displayNewsData(sampleNews);
                    newsLoading.style.display = 'none';
                    newsData.style.display = 'block';
                }, 2000);
                
            } catch (error) {
                console.error('Error fetching real news:', error);
                loadFallbackNews();
            }
        }

        // Ù†Ù…Ø§ÛŒØ´ Ø§Ø®Ø¨Ø§Ø±
        function displayNewsData(news) {
            const newsDataDiv = document.getElementById('newsData');
            
            let html = '<div style="display: grid; gap: 15px;">';
            
            news.forEach(item => {
                html += `
                    <div style="background: #f8fafc; padding: 15px; border-radius: 10px; border-right: 4px solid #3b82f6;">
                        <h4 style="margin-bottom: 10px; font-size: 1.1rem;">
                            <a href="${item.url}" target="_blank" style="color: inherit; text-decoration: none;">
                                ${item.title}
                            </a>
                        </h4>
                        <p style="color: #6b7280; margin-bottom: 10px; font-size: 0.9rem;">${item.description}</p>
                        <div style="display: flex; justify-content: space-between; font-size: 0.8rem; color: #9ca3af;">
                            <span>Ù…Ù†Ø¨Ø¹: ${item.source}</span>
                            <span>${item.time}</span>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            newsDataDiv.innerHTML = html;
        }

        // Ø§Ø®Ø¨Ø§Ø± Ù¾Ø´ØªÛŒØ¨Ø§Ù†
        function loadFallbackNews() {
            const news = [
                {
                    title: 'Ø¨Ø§Ø²Ø§Ø± Ø§Ø±Ø²Ù‡Ø§ÛŒ Ø¯ÛŒØ¬ÛŒØªØ§Ù„ Ø¨Ø§ Ø±Ø´Ø¯ Ù…Ø«Ø¨Øª Ø±ÙˆØ¨Ø±Ùˆ Ø´Ø¯',
                    description: 'Ù‚ÛŒÙ…Øª Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ† Ùˆ Ø§ØªØ±ÛŒÙˆÙ… Ø¯Ø± Û²Û´ Ø³Ø§Ø¹Øª Ú¯Ø°Ø´ØªÙ‡ Ø±Ø´Ø¯ Ù‚Ø§Ø¨Ù„ ØªÙˆØ¬Ù‡ÛŒ Ø±Ø§ ØªØ¬Ø±Ø¨Ù‡ Ú©Ø±Ø¯Ù†Ø¯.',
                    source: 'Mousa Trading',
                    time: 'Ù‡Ù… Ø§Ú©Ù†ÙˆÙ†',
                    url: '#'
                },
                {
                    title: 'ØªØ­Ù„ÛŒÙ„â€ŒÚ¯Ø±Ø§Ù† Ù¾ÛŒØ´â€ŒØ¨ÛŒÙ†ÛŒ Ø±Ø´Ø¯ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø³Ù‡Ø§Ù…',
                    description: 'Ú©Ø§Ø±Ø´Ù†Ø§Ø³Ø§Ù† Ù…Ø¹ØªÙ‚Ø¯Ù†Ø¯ Ø´Ø§Ø®Øµâ€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„ÛŒ Ø¨ÙˆØ±Ø³ Ø¯Ø± Ù‡ÙØªÙ‡ Ø¢ÛŒÙ†Ø¯Ù‡ Ø±ÙˆÙ†Ø¯ ØµØ¹ÙˆØ¯ÛŒ Ø®ÙˆØ§Ù‡Ù†Ø¯ Ø¯Ø§Ø´Øª.',
                    source: 'Mousa Trading',
                    time: 'Û± Ø³Ø§Ø¹Øª Ù¾ÛŒØ´',
                    url: '#'
                }
            ];
            displayNewsData(news);
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø± Ø§Ø² APIÙ‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù
        async function loadMarketData() {
            try {
                document.getElementById('connectionStatus').className = 'connection-status online';
                document.getElementById('connectionStatus').innerHTML = 'ğŸ”— Ø¢Ù†Ù„Ø§ÛŒÙ† - Ø¯Ø± Ø­Ø§Ù„ Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ù‡Ø§...';
                
                let data = {};
                
                switch(currentDataSource) {
                    case 'coingecko':
                        data = await loadCoinGeckoData();
                        break;
                    case 'binance':
                        data = await loadBinanceData();
                        break;
                    case 'xchief':
                        data = await loadXChiefData();
                        break;
                    case 'alphavantage':
                        data = await loadAlphaVantageData();
                        break;
                    case 'tsetmc':
                        data = await loadTSETMCData();
                        break;
                    case 'mofid':
                        data = await loadMofidData();
                        break;
                }
                
                currentPrices = data;
                displayMarketData(data);
                updateTicker(data);
                
                document.getElementById('connectionStatus').innerHTML = 'ğŸ”— Ø¢Ù†Ù„Ø§ÛŒÙ† - Ø§ØªØµØ§Ù„ Ø¨Ø±Ù‚Ø±Ø§Ø±';
                
            } catch (error) {
                console.error('Error fetching market data:', error);
                document.getElementById('connectionStatus').className = 'connection-status offline';
                document.getElementById('connectionStatus').innerHTML = 'ğŸ”´ Ø¢ÙÙ„Ø§ÛŒÙ† - Ø®Ø·Ø§ Ø¯Ø± Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ù‡Ø§';
            }
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ø§Ø² CoinGecko
        async function loadCoinGeckoData() {
            try {
                const response = await fetch('https://api.coingecko.com/api/v3/simple/price?ids=bitcoin,ethereum,binancecoin,ripple,cardano&vs_currencies=usd&include_24hr_change=true');
                if (!response.ok) throw new Error('CoinGecko API Error');
                return await response.json();
            } catch (error) {
                console.error('CoinGecko API Error:', error);
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡
                return {
                    bitcoin: { usd: 45000, usd_24h_change: 2.5 },
                    ethereum: { usd: 3200, usd_24h_change: 1.8 },
                    binancecoin: { usd: 580, usd_24h_change: -0.5 },
                    ripple: { usd: 0.75, usd_24h_change: 3.2 },
                    cardano: { usd: 1.2, usd_24h_change: -1.2 }
                };
            }
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ø§Ø² Binance
        async function loadBinanceData() {
            try {
                const symbols = ['BTCUSDT', 'ETHUSDT', 'BNBUSDT', 'XRPUSDT', 'ADAUSDT'];
                const data = {};
                
                for (const symbol of symbols) {
                    try {
                        const response = await fetch(`https://api.binance.com/api/v3/ticker/24hr?symbol=${symbol}`);
                        if (!response.ok) continue;
                        
                        const ticker = await response.json();
                        
                        const coinId = symbol.replace('USDT', '').toLowerCase();
                        if (coinId === 'bnb') coinId = 'binancecoin';
                        
                        data[coinId] = {
                            usd: parseFloat(ticker.lastPrice),
                            usd_24h_change: parseFloat(ticker.priceChangePercent)
                        };
                    } catch (error) {
                        console.error(`Error fetching ${symbol}:`, error);
                    }
                }
                
                return data;
            } catch (error) {
                console.error('Binance API Error:', error);
                return loadCoinGeckoData(); // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ CoinGecko
            }
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ø§Ø² XChief
        async function loadXChiefData() {
            if (!xchiefConnected) {
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ XChief
                return {
                    'xcf': { usd: 0.45, usd_24h_change: 2.1 },
                    'btc': { usd: 45000, usd_24h_change: 1.8 },
                    'eth': { usd: 3200, usd_24h_change: 0.9 }
                };
            }
            
            try {
                const response = await advancedProxy.fetchWithProxy(`${API_CONFIG.XCHIEF}/tickers`);
                const data = await response.json();
                return data;
            } catch (error) {
                return loadCoinGeckoData();
            }
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ø§Ø² Alpha Vantage
        async function loadAlphaVantageData() {
            // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ ÙØ§Ø±Ú©Ø³ Ùˆ Ø³Ù‡Ø§Ù…
            return {
                'eur/usd': { usd: 1.0850, usd_24h_change: 0.15 },
                'gbp/usd': { usd: 1.2650, usd_24h_change: -0.25 },
                'aapl': { usd: 185.50, usd_24h_change: 1.2 },
                'msft': { usd: 420.75, usd_24h_change: 0.8 }
            };
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ø§Ø² TSETMC
        async function loadTSETMCData() {
            // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ø¨ÙˆØ±Ø³ ØªÙ‡Ø±Ø§Ù†
            return {
                'Ø´Ø§Ø®Øµ Ú©Ù„': { usd: 2100000, usd_24h_change: 1.2 },
                'Ø´Ø§Ø®Øµ Ù‡Ù… ÙˆØ²Ù†': { usd: 480000, usd_24h_change: 0.8 },
                'ÙÙ…Ù„ÛŒ': { usd: 45000, usd_24h_change: -0.5 },
                'ÙÙˆÙ„Ø§Ø¯': { usd: 38000, usd_24h_change: 1.8 }
            };
        }

        // Ø¯Ø±ÛŒØ§ÙØª Ø¯Ø§Ø¯Ù‡ Ø§Ø² Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
        async function loadMofidData() {
            if (!mofidConnected) {
                // Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø¨Ø±Ø§ÛŒ Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯
                return {
                    'ÙÙ…Ù„ÛŒ': { usd: 45000, usd_24h_change: 1.2 },
                    'ÙÙˆÙ„Ø§Ø¯': { usd: 38000, usd_24h_change: 2.1 },
                    'Ú©Ú¯Ù„': { usd: 12000, usd_24h_change: -0.5 },
                    'ÙˆØ¨ØµØ§Ø¯Ø±': { usd: 28000, usd_24h_change: 3.2 }
                };
            }
            
            try {
                const response = await advancedProxy.fetchWithProxy(`${API_CONFIG.MOFID}/tickers`);
                const data = await response.json();
                return data;
            } catch (error) {
                return loadTSETMCData();
            }
        }

        // Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ù‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±
        function displayMarketData(data) {
            const marketDataDiv = document.getElementById('marketData');
            const loadingDiv = document.getElementById('marketLoading');
            
            let html = '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 12px;">';
            
            for (const [coin, info] of Object.entries(data)) {
                const coinName = getCoinName(coin);
                const price = info.usd.toLocaleString();
                const change = info.usd_24h_change.toFixed(2);
                const changeClass = change >= 0 ? 'positive' : 'negative';
                const changeSign = change >= 0 ? '+' : '';
                
                html += `
                    <div class="price-card">
                        <h3 style="font-size: 1.1rem;">${coinName}</h3>
                        <div class="current-price">$${price}</div>
                        <div class="price-change ${changeClass}">${changeSign}${change}%</div>
                        <div style="margin-top: 10px; font-size: 12px; color: #6b7280;">
                            Ù…Ù†Ø¨Ø¹: ${getDataSourceName(currentDataSource)}
                        </div>
                    </div>
                `;
            }
            
            html += '</div>';
            marketDataDiv.innerHTML = html;
            loadingDiv.style.display = 'none';
            marketDataDiv.style.display = 'block';
        }

        // Ù†Ø§Ù… Ù…Ù†Ø¨Ø¹ Ø¯Ø§Ø¯Ù‡
        function getDataSourceName(source) {
            const names = {
                'coingecko': 'CoinGecko',
                'binance': 'Binance',
                'xchief': 'XChief',
                'alphavantage': 'Alpha Vantage',
                'tsetmc': 'TSETMC',
                'mofid': 'Ú©Ø§Ø±Ú¯Ø²Ø§Ø±ÛŒ Ù…ÙÛŒØ¯'
            };
            return names[source] || source;
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ ØªÛŒÚ©Ø±
        function updateTicker(data) {
            const tickerContent = document.getElementById('tickerContent');
            let html = '';
            
            for (const [coin, info] of Object.entries(data)) {
                const coinName = getCoinName(coin);
                const price = info.usd.toLocaleString();
                const change = info.usd_24h_change.toFixed(2);
                const changeClass = change >= 0 ? 'positive' : 'negative';
                const changeSign = change >= 0 ? '+' : '';
                
                html += `
                    <div class="ticker-item">
                        <strong>${coinName}:</strong> $${price} 
                        <span class="${changeClass}">(${changeSign}${change}%)</span>
                    </div>
                `;
            }
            
            tickerContent.innerHTML = html + html; // Ø¯Ùˆ Ø¨Ø§Ø± Ø¨Ø±Ø§ÛŒ ØªÛŒÚ©Ø± Ù¾ÛŒÙˆØ³ØªÙ‡
        }

        // Ù†Ø§Ù… Ú©Ø§Ù…Ù„ Ø§Ø±Ø²Ù‡Ø§
        function getCoinName(coinId) {
            const names = {
                'bitcoin': 'Ø¨ÛŒØªâ€ŒÚ©ÙˆÛŒÙ†',
                'ethereum': 'Ø§ØªØ±ÛŒÙˆÙ…', 
                'binancecoin': 'Ø¨Ø§ÛŒÙ†Ù†Ø³ Ú©ÙˆÛŒÙ†',
                'ripple': 'Ø±ÛŒÙ¾Ù„',
                'cardano': 'Ú©Ø§Ø±Ø¯Ø§Ù†Ùˆ',
                'xcf': 'XCHIEF Token',
                'Ø´Ø§Ø®Øµ Ú©Ù„': 'Ø´Ø§Ø®Øµ Ú©Ù„ Ø¨ÙˆØ±Ø³',
                'Ø´Ø§Ø®Øµ Ù‡Ù… ÙˆØ²Ù†': 'Ø´Ø§Ø®Øµ Ù‡Ù… ÙˆØ²Ù†',
                'ÙÙ…Ù„ÛŒ': 'ÙÙˆÙ„Ø§Ø¯ Ù…Ø¨Ø§Ø±Ú©Ù‡',
                'ÙÙˆÙ„Ø§Ø¯': 'ÙÙˆÙ„Ø§Ø¯ Ø®ÙˆØ²Ø³ØªØ§Ù†',
                'Ú©Ú¯Ù„': 'Ú©Ú¯Ù„',
                'ÙˆØ¨ØµØ§Ø¯Ø±': 'ÙˆØ¨ØµØ§Ø¯Ø±',
                'eur/usd': 'ÛŒÙˆØ±Ùˆ/Ø¯Ù„Ø§Ø±',
                'gbp/usd': 'Ù¾ÙˆÙ†Ø¯/Ø¯Ù„Ø§Ø±',
                'aapl': 'Ø§Ù¾Ù„',
                'msft': 'Ù…Ø§ÛŒÚ©Ø±ÙˆØ³Ø§ÙØª'
            };
            return names[coinId] || coinId;
        }

        // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù‡Ø± Ù…Ø±Ø­Ù„Ù‡ ØªØ­Ù„ÛŒÙ„
        function validateAnalysisStep(step) {
            if (step === 1) {
                const market = document.getElementById('analysisMarket').value;
                if (!market) {
                    alert('Ù„Ø·ÙØ§ Ø¨Ø§Ø²Ø§Ø± Ù…ÙˆØ±Ø¯ ØªØ­Ù„ÛŒÙ„ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                    return false;
                }
            } else if (step === 2) {
                const symbol = document.getElementById('analysisSymbol').value;
                if (!symbol) {
                    alert('Ù„Ø·ÙØ§ Ù†Ù…Ø§Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                    return false;
                }
            }
            return true;
        }

        // Ø§Ø¬Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡
        async function runAdvancedAnalysis() {
            const symbol = document.getElementById('analysisSymbol').value;
            const amount = parseFloat(document.getElementById('analysisAmount').value);
            const leverage = parseInt(document.getElementById('analysisLeverage').value);
            
            if (!symbol) {
                alert('Ù„Ø·ÙØ§ ÛŒÚ© Ù†Ù…Ø§Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            const resultsDiv = document.getElementById('analysisResults');
            const contentDiv = document.getElementById('resultsContent');
            
            // Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª ØªØ­Ù„ÛŒÙ„
            contentDiv.innerHTML = `
                <div style="background: #f0f9ff; padding: 15px; border-radius: 10px; margin: 12px 0;">
                    <h4>ğŸ” Ø¯Ø± Ø­Ø§Ù„ ØªØ­Ù„ÛŒÙ„ ${getCoinName(symbol)}...</h4>
                    <div class="analysis-status ${isOnline ? 'analysis-live' : 'analysis-offline'}">
                        ${isOnline ? 'ğŸŸ¢ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ' : 'ğŸŸ¡ ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡'}
                    </div>
                    <div class="progress-bar" style="margin-top: 10px;">
                        <div class="progress-fill" style="width: 0%"></div>
                    </div>
                </div>
            `;
            
            resultsDiv.style.display = 'block';
            resultsDiv.scrollIntoView({ behavior: 'smooth' });
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø±Ø¯Ø§Ø²Ø´
            await simulateAnalysisProgress();
            
            // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬
            const analysisResult = generateFallbackAnalysis();
            displayAnalysisResults(analysisResult, symbol, amount, leverage, isOnline);
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØª ØªØ­Ù„ÛŒÙ„
        function simulateAnalysisProgress() {
            return new Promise((resolve) => {
                const progressFill = document.querySelector('.progress-fill');
                let progress = 0;
                
                const interval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress >= 100) {
                        progress = 100;
                        clearInterval(interval);
                        resolve();
                    }
                    progressFill.style.width = progress + '%';
                }, 200);
            });
        }

        // ØªØ­Ù„ÛŒÙ„ Ù¾Ø´ØªÛŒØ¨Ø§Ù†
        function generateFallbackAnalysis() {
            const probability = Math.floor(Math.random() * 30) + 65;
            return {
                probability: probability,
                decision: probability >= 75 ? 'Ø®Ø±ÛŒØ¯' : probability >= 60 ? 'Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ' : 'ÙØ±ÙˆØ´',
                confidence: probability >= 80 ? 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¨Ø³ÛŒØ§Ø± Ø¨Ø§Ù„Ø§' : 
                            probability >= 70 ? 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¨Ø§Ù„Ø§' : 
                            probability >= 60 ? 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ù…ØªÙˆØ³Ø·' : 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ù¾Ø§ÛŒÛŒÙ†',
                riskLevel: probability >= 80 ? 'Ù¾Ø§ÛŒÛŒÙ†' : 
                          probability >= 65 ? 'Ù…ØªÙˆØ³Ø·' : 'Ø¨Ø§Ù„Ø§',
                realData: false,
                priceChange: (Math.random() * 10 - 5).toFixed(2),
                currentPrice: (Math.random() * 1000 + 100).toFixed(2)
            };
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„
        function displayAnalysisResults(analysisResult, symbol, amount, leverage, isOnline) {
            const contentDiv = document.getElementById('resultsContent');
            const profitPotential = (amount * leverage * (analysisResult.probability / 100) * 0.1).toFixed(2);
            const lossPotential = (amount * leverage * ((100 - analysisResult.probability) / 100) * 0.05).toFixed(2);
            
            contentDiv.innerHTML = `
                <div style="background: #f0f9ff; padding: 15px; border-radius: 10px; margin: 12px 0;">
                    <h4 style="font-size: 1.1rem;">
                        ğŸ“ˆ ØªØ­Ù„ÛŒÙ„ ${getCoinName(symbol)} 
                        <span class="analysis-status ${isOnline ? 'analysis-live' : 'analysis-offline'}" style="font-size: 0.7rem;">
                            ${isOnline ? 'ğŸŸ¢ Ø¯Ø§Ø¯Ù‡ ÙˆØ§Ù‚Ø¹ÛŒ' : 'ğŸŸ¡ Ø¯Ø§Ø¯Ù‡ Ù†Ù…ÙˆÙ†Ù‡'}
                        </span>
                    </h4>
                    
                    ${isOnline ? 
                        '<div class="api-test-result api-success">âœ… ØªØ­Ù„ÛŒÙ„ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡ Ø¨Ø§Ø²Ø§Ø± Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯</div>' :
                        '<div class="api-test-result api-error">âš ï¸ Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†ÛŒØ³Øª - ØªØ­Ù„ÛŒÙ„ Ø¨Ø§ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…ÙˆÙ†Ù‡ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯</div>'
                    }
                    
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin: 12px 0;">
                        <div class="result-card">
                            <div>Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª</div>
                            <div style="font-size: 20px; font-weight: bold; color: #3b82f6;">${analysisResult.probability}%</div>
                        </div>
                        <div class="result-card">
                            <div>ØªÙˆØµÛŒÙ‡ Mousa</div>
                            <div style="font-size: 18px; font-weight: bold; color: ${analysisResult.decision === 'Ø®Ø±ÛŒØ¯' ? '#10b981' : analysisResult.decision === 'ÙØ±ÙˆØ´' ? '#ef4444' : '#f59e0b'};">${analysisResult.decision}</div>
                        </div>
                        <div class="result-card">
                            <div>Ø³Ø·Ø­ Ø±ÛŒØ³Ú©</div>
                            <div style="font-size: 16px; color: ${analysisResult.riskLevel === 'Ø¨Ø§Ù„Ø§' ? '#ef4444' : analysisResult.riskLevel === 'Ù…ØªÙˆØ³Ø·' ? '#f59e0b' : '#10b981'};">${analysisResult.riskLevel}</div>
                        </div>
                        <div class="result-card">
                            <div>ØªØºÛŒÛŒØ± Ù‚ÛŒÙ…Øª</div>
                            <div style="font-size: 16px; font-weight: bold; color: ${analysisResult.priceChange >= 0 ? '#10b981' : '#ef4444'};">${analysisResult.priceChange >= 0 ? '+' : ''}${analysisResult.priceChange}%</div>
                        </div>
                    </div>
                    
                    <div style="background: #f8fafc; padding: 12px; border-radius: 8px; margin: 12px 0;">
                        <h5>ğŸ’° Ù…Ø­Ø§Ø³Ø¨Ø§Øª Ù…Ø§Ù„ÛŒ</h5>
                        <div>Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø§ÙˆÙ„ÛŒÙ‡: $${amount.toLocaleString()}</div>
                        <div>Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø¨Ø§ Ø§Ù‡Ø±Ù…: $${(amount * leverage).toLocaleString()}</div>
                        <div>Ø­Ø¯Ø§Ú©Ø«Ø± Ø³ÙˆØ¯ Ø§Ø­ØªÙ…Ø§Ù„ÛŒ: <span class="profit">+$${profitPotential}</span></div>
                        <div>Ø­Ø¯Ø§Ú©Ø«Ø± Ø¶Ø±Ø± Ø§Ø­ØªÙ…Ø§Ù„ÛŒ: <span class="loss">-$${lossPotential}</span></div>
                    </div>
                </div>
                
                <div style="background: #fef3c7; padding: 12px; border-radius: 10px; margin: 12px 0;">
                    <strong>âš ï¸ Ù‡Ø´Ø¯Ø§Ø± Ø±ÛŒØ³Ú©:</strong> Ø§ÛŒÙ† ØªØ­Ù„ÛŒÙ„ ØµØ±ÙØ§Ù‹ Ø¬Ù†Ø¨Ù‡ Ø¢Ù…ÙˆØ²Ø´ÛŒ Ø¯Ø§Ø±Ø¯ Ùˆ ØªÙˆØµÛŒÙ‡ Ù…Ø§Ù„ÛŒ Ù…Ø­Ø³ÙˆØ¨ Ù†Ù…ÛŒâ€ŒØ´ÙˆØ¯. 
                    Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù‡Ø±Ù…ÛŒ Ø±ÛŒØ³Ú© Ø¨Ø§Ù„Ø§ÛŒÛŒ Ø¯Ø§Ø±Ù†Ø¯ Ùˆ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù…Ù†Ø¬Ø± Ø¨Ù‡ Ø§Ø² Ø¯Ø³Øª Ø¯Ø§Ø¯Ù† Ú©Ù„ Ø³Ø±Ù…Ø§ÛŒÙ‡ Ø´ÙˆÙ†Ø¯.
                </div>
            `;
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø§Ù‡Ø±Ù… Ø¯Ø± Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨
        function updateCalcLeverage() {
            const leverage = document.getElementById('calcLeverage').value;
            document.getElementById('calcLeverageValue').textContent = leverage + 'x';
            calculateTrade();
        }

        // Ù…Ø­Ø§Ø³Ø¨Ù‡ Ù…Ø¹Ø§Ù…Ù„Ù‡
        function calculateTrade() {
            const amount = parseFloat(document.getElementById('calcAmount').value) || 1000;
            const leverage = parseInt(document.getElementById('calcLeverage').value);
            const priceChange = parseFloat(document.getElementById('calcPriceChange').value);
            const position = document.getElementById('calcPosition').value;
            
            const leveragedAmount = amount * leverage;
            const profit = (leveragedAmount * priceChange / 100).toFixed(2);
            const loss = (leveragedAmount * priceChange / 100).toFixed(2);
            
            document.getElementById('calcInitial').textContent = `$${amount.toLocaleString()}`;
            document.getElementById('calcLeveraged').textContent = `$${leveragedAmount.toLocaleString()}`;
            document.getElementById('calcProfit').textContent = `+$${profit}`;
            document.getElementById('calcLoss').textContent = `-$${loss}`;
        }

        // Ø¨Ù‡ Ø±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù‚ÛŒÙ…Øª Ø¯Ø± Ù…Ø§Ø´ÛŒÙ† Ø­Ø³Ø§Ø¨
        function updateCalcPrice() {
            calculateTrade();
        }

        // Ù…Ø¯ÛŒØ±ÛŒØª Ù…Ø±Ø§Ø­Ù„ ÙØ±Ù… Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa
        function nextStep(step) {
            if (validateStep(step)) {
                document.querySelectorAll('.form-step').forEach(stepEl => {
                    stepEl.classList.remove('active');
                });
                
                currentStep = step + 1;
                const nextStepEl = document.getElementById(`step${currentStep}`);
                if (nextStepEl) {
                    nextStepEl.classList.add('active');
                    
                    if (currentStep === 2) {
                        populateSymbols();
                    }
                    
                    updateSelectionSummary();
                }
            }
        }

        function prevStep(step) {
            document.querySelectorAll('.form-step').forEach(stepEl => {
                stepEl.classList.remove('active');
            });
            
            currentStep = step - 1;
            const prevStepEl = document.getElementById(`step${currentStep}`);
            if (prevStepEl) {
                prevStepEl.classList.add('active');
            }
        }

        // Ø§Ø¹ØªØ¨Ø§Ø±Ø³Ù†Ø¬ÛŒ Ù‡Ø± Ù…Ø±Ø­Ù„Ù‡
        function validateStep(step) {
            switch(step) {
                case 1:
                    const marketSelect = document.getElementById('marketSelect');
                    const market = marketSelect.value;
                    if (!market) {
                        alert('Ù„Ø·ÙØ§ Ø¨Ø§Ø²Ø§Ø± Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                        marketSelect.focus();
                        return false;
                    }
                    userSelections.market = market;
                    return true;
                    
                case 2:
                    const symbolSelect = document.getElementById('symbolSelect');
                    const symbol = symbolSelect.value;
                    if (!symbol) {
                        alert('Ù„Ø·ÙØ§ Ù†Ù…Ø§Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                        symbolSelect.focus();
                        return false;
                    }
                    userSelections.symbol = symbol;
                    return true;
                    
                case 3:
                    const amount = document.getElementById('investmentAmount').value;
                    if (!amount || amount < 10) {
                        alert('Ù„Ø·ÙØ§ Ù…Ù‚Ø¯Ø§Ø± Ø³Ø±Ù…Ø§ÛŒÙ‡ Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯ (Ø­Ø¯Ø§Ù‚Ù„ 10 Ø¯Ù„Ø§Ø±)');
                        document.getElementById('investmentAmount').focus();
                        return false;
                    }
                    userSelections.amount = amount;
                    return true;
                    
                default:
                    return true;
            }
        }

        // Ù¾Ø± Ú©Ø±Ø¯Ù† Ù†Ù…Ø§Ø¯Ù‡Ø§
        function populateSymbols() {
            const select = document.getElementById('symbolSelect');
            select.innerHTML = '<option value="">-- Ù„Ø·ÙØ§ Ù†Ù…Ø§Ø¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯ --</option>';
            
            const market = userSelections.market;
            if (symbolsData[market]) {
                symbolsData[market].forEach(symbol => {
                    const option = document.createElement('option');
                    option.value = symbol;
                    option.textContent = symbol;
                    select.appendChild(option);
                });
            }
        }

        // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø®Ù„Ø§ØµÙ‡ Ø§Ù†ØªØ®Ø§Ø¨â€ŒÙ‡Ø§
        function updateSelectionSummary() {
            const summaryDiv = document.getElementById('selectionSummary');
            const summaryContent = document.getElementById('summaryContent');
            
            if (Object.keys(userSelections).length > 0) {
                let html = '<div class="summary-grid">';
                
                if (userSelections.market) {
                    html += `<div class="summary-item"><strong>Ø¨Ø§Ø²Ø§Ø±:</strong> ${userSelections.market}</div>`;
                }
                
                if (userSelections.symbol) {
                    html += `<div class="summary-item"><strong>Ù†Ù…Ø§Ø¯:</strong> ${userSelections.symbol}</div>`;
                }
                
                if (userSelections.amount) {
                    html += `<div class="summary-item"><strong>Ø³Ø±Ù…Ø§ÛŒÙ‡:</strong> ${userSelections.amount} Ø¯Ù„Ø§Ø±</div>`;
                }
                
                html += '</div>';
                summaryContent.innerHTML = html;
                summaryDiv.style.display = 'block';
            }
        }

        // Ø§Ø¬Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa
        function runMousaAIAnalysis() {
            const timeframe = document.getElementById('timeframeSelect').value;
            if (!timeframe) {
                alert('Ù„Ø·ÙØ§ Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯');
                return;
            }
            
            userSelections.timeframe = timeframe;
            
            // Ù†Ù…Ø§ÛŒØ´ ÙˆØ¶Ø¹ÛŒØª ØªØ­Ù„ÛŒÙ„
            const resultsDiv = document.getElementById('mousaAIResults');
            resultsDiv.style.display = 'block';
            resultsDiv.innerHTML = `
                <div class="analysis-progress">
                    <div style="background: #f0f9ff; padding: 15px; border-radius: 10px;">
                        <h4>ğŸ§  Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§ÛŒ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa...</h4>
                        <div style="margin-top: 12px;">
                            <div>ğŸ” Ø¬Ù…Ø¹â€ŒØ¢ÙˆØ±ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø¨Ø§Ø²Ø§Ø±</div>
                            <div>ğŸ“Š ØªØ­Ù„ÛŒÙ„ ØªÚ©Ù†ÛŒÚ©Ø§Ù„ (35 Ø§Ù†Ø¯ÛŒÚ©Ø§ØªÙˆØ±)</div>
                            <div>ğŸ“° ØªØ­Ù„ÛŒÙ„ Ø§Ø®Ø¨Ø§Ø± Ùˆ Ø³Ù†ØªÛŒÙ…Ù†Øª</div>
                            <div>ğŸ¤– Ù¾Ø±Ø¯Ø§Ø²Ø´ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</div>
                            <div>ğŸ¯ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø§Ø­ØªÙ…Ø§Ù„ Ùˆ Ø§Ù‡Ø¯Ø§Ù Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ</div>
                        </div>
                        <div class="progress-bar" style="margin-top: 10px;">
                            <div class="progress-fill" style="width: 0%"></div>
                        </div>
                    </div>
                </div>
            `;
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØª
            simulateMousaAnalysisProgress();
        }

        // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾ÛŒØ´Ø±ÙØª ØªØ­Ù„ÛŒÙ„ Mousa
        function simulateMousaAnalysisProgress() {
            const progressFill = document.querySelector('.progress-fill');
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    setTimeout(() => {
                        showMousaAdvancedResults();
                    }, 500);
                }
                progressFill.style.width = progress + '%';
            }, 300);
        }

        // Ù†Ù…Ø§ÛŒØ´ Ù†ØªØ§ÛŒØ¬ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Mousa
        function showMousaAdvancedResults() {
            const resultsDiv = document.getElementById('mousaAIResults');
            const analysisResult = generateMousaAdvancedAnalysis();
            
            resultsDiv.innerHTML = `
                <div class="advanced-results">
                    <h4>ğŸ§  Ù†ØªØ§ÛŒØ¬ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ Mousa</h4>
                    
                    <!-- Ú©Ø§Ø±Øª Ù†ØªÛŒØ¬Ù‡ Ù†Ù‡Ø§ÛŒÛŒ -->
                    <div class="final-prediction ${analysisResult.decisionColor}">
                        <div class="prediction-header">
                            <div class="symbol-info">
                                <h3 style="font-size: 1.2rem;">${userSelections.symbol}</h3>
                                <small>${userSelections.market} - ${getTimeframeLabel(userSelections.timeframe)}</small>
                            </div>
                            <div class="timeframe">â° ${getTimeframeLabel(userSelections.timeframe)}</div>
                        </div>
                        
                        <div style="display: flex; justify-content: center; align-items: center; gap: 20px; flex-wrap: wrap;">
                            <div class="probability-circle">
                                <div class="circle-value">${analysisResult.probability}%</div>
                                <div class="circle-label">Ø§Ø­ØªÙ…Ø§Ù„ Ù…ÙˆÙÙ‚ÛŒØª</div>
                            </div>
                            
                            <div class="decision">
                                <div class="decision-text">${analysisResult.decision}</div>
                                <div class="decision-subtext">${analysisResult.confidence}</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Ø§Ù‡Ø¯Ø§Ù Ù…Ø¹Ø§Ù…Ù„Ø§ØªÛŒ -->
                    <div class="trading-targets-grid">
                        <div class="target-card profit">
                            <div class="target-icon">ğŸ¯</div>
                            <div class="target-label">Ø­Ø¯ Ø³ÙˆØ¯</div>
                            <div class="target-value">${analysisResult.targets.takeProfit}</div>
                        </div>
                        
                        <div class="target-card loss">
                            <div class="target-icon">ğŸ›¡ï¸</div>
                            <div class="target-label">Ø­Ø¯ Ø¶Ø±Ø±</div>
                            <div class="target-value">${analysisResult.targets.stopLoss}</div>
                        </div>
                        
                        <div class="target-card time">
                            <div class="target-icon">â±ï¸</div>
                            <div class="target-label">Ø²Ù…Ø§Ù† Ø¨Ø§Ø²Ø¯Ù‡ÛŒ</div>
                            <div class="target-value">${analysisResult.targets.timeToResult}</div>
                        </div>
                        
                        <div class="target-card risk">
                            <div class="target-icon">ğŸ“Š</div>
                            <div class="target-label">Ø³Ø·Ø­ Ø±ÛŒØ³Ú©</div>
                            <div class="target-value" style="color: ${analysisResult.riskLevel === 'Ø¨Ø§Ù„Ø§' ? '#ef4444' : analysisResult.riskLevel === 'Ù…ØªÙˆØ³Ø·' ? '#f59e0b' : '#10b981'}">
                                ${analysisResult.riskLevel}
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-actions" style="margin-top: 20px;">
                    <button class="btn" onclick="restartAnalysis()" style="background: #6b7280;">
                        ğŸ”„ Ø´Ø±ÙˆØ¹ Ù…Ø¬Ø¯Ø¯
                    </button>
                    <button class="btn" onclick="saveCurrentAnalysis()" style="background: #10b981;">
                        ğŸ’¾ Ø°Ø®ÛŒØ±Ù‡ ØªØ­Ù„ÛŒÙ„
                    </button>
                </div>
            `;
        }

        // ØªØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ ØªØ­Ù„ÛŒÙ„ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Mousa
        function generateMousaAdvancedAnalysis() {
            const probability = Math.floor(Math.random() * 30 + 65); // 65-95%
            const decision = probability >= 75 ? 'Ø®Ø±ÛŒØ¯' : probability >= 60 ? 'Ù†Ú¯Ù‡Ø¯Ø§Ø±ÛŒ' : 'ÙØ±ÙˆØ´';
            const decisionColor = decision === 'Ø®Ø±ÛŒØ¯' ? '' : decision === 'ÙØ±ÙˆØ´' ? 'danger' : 'warning';
            
            return {
                probability: probability,
                decision: decision,
                decisionColor: decisionColor,
                confidence: probability >= 80 ? 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¨Ø³ÛŒØ§Ø± Ø¨Ø§Ù„Ø§' : 
                            probability >= 70 ? 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¨Ø§Ù„Ø§' : 
                            probability >= 60 ? 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ù…ØªÙˆØ³Ø·' : 'Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ù¾Ø§ÛŒÛŒÙ†',
                riskLevel: probability >= 80 ? 'Ù¾Ø§ÛŒÛŒÙ†' : 
                          probability >= 65 ? 'Ù…ØªÙˆØ³Ø·' : 'Ø¨Ø§Ù„Ø§',
                targets: {
                    takeProfit: (Math.random() * 20 + 5).toFixed(1) + '%',
                    stopLoss: (Math.random() * 8 + 2).toFixed(1) + '%',
                    timeToResult: userSelections.timeframe === '5min' ? '15-30 Ø¯Ù‚ÛŒÙ‚Ù‡' :
                                 userSelections.timeframe === '1h' ? '2-4 Ø³Ø§Ø¹Øª' :
                                 userSelections.timeframe === '1d' ? '1-3 Ø±ÙˆØ²' : '3-7 Ø±ÙˆØ²'
                }
            };
        }

        // ØªÙˆØ§Ø¨Ø¹ Ú©Ù…Ú©ÛŒ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¨Ø±Ú†Ø³Ø¨â€ŒÙ‡Ø§
        function getTimeframeLabel(timeframe) {
            const labels = {
                '5min': '5 Ø¯Ù‚ÛŒÙ‚Ù‡',
                '15min': '15 Ø¯Ù‚ÛŒÙ‚Ù‡',
                '1h': '1 Ø³Ø§Ø¹Øª',
                '4h': '4 Ø³Ø§Ø¹Øª',
                '1d': '1 Ø±ÙˆØ²',
                '3d': '3 Ø±ÙˆØ²',
                '1w': '1 Ù‡ÙØªÙ‡'
            };
            return labels[timeframe] || timeframe;
        }

        function saveCurrentAnalysis() {
            showNotification('âœ… ØªØ­Ù„ÛŒÙ„ ÙØ¹Ù„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯');
        }

        function restartAnalysis() {
            currentStep = 1;
            userSelections = {};
            
            document.querySelectorAll('.form-step').forEach(stepEl => {
                stepEl.classList.remove('active');
            });
            
            document.getElementById('step1').classList.add('active');
            document.getElementById('selectionSummary').style.display = 'none';
            document.getElementById('mousaAIResults').style.display = 'none';
            
            showNotification('ğŸ”„ ØªØ­Ù„ÛŒÙ„ Ø¬Ø¯ÛŒØ¯ Ø´Ø±ÙˆØ¹ Ø´Ø¯');
        }

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡
        function loadSavedAnalyses() {
            const savedAnalyses = JSON.parse(localStorage.getItem('mousaSavedAnalyses') || '[]');
            const listDiv = document.getElementById('savedAnalysesList');
            
            if (savedAnalyses.length === 0) {
                listDiv.innerHTML = '<div class="loading">Ù‡ÛŒÚ† ØªØ­Ù„ÛŒÙ„ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ù†Ø´Ø¯Ù‡ Ø§Ø³Øª</div>';
                return;
            }
            
            let html = '<div style="display: grid; gap: 15px;">';
            
            savedAnalyses.forEach(analysis => {
                html += `
                    <div style="background: white; padding: 15px; border-radius: 10px; border: 2px solid #e5e7eb;">
                        <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 10px;">
                            <h4>${analysis.symbol} - ${analysis.market}</h4>
                            <div>
                                <small style="color: #6b7280;">${analysis.timestamp}</small>
                                <button onclick="deleteAnalysis(${analysis.id})" style="background: #ef4444; color: white; border: none; padding: 5px 10px; border-radius: 5px; margin-right: 10px; cursor: pointer;">
                                    Ø­Ø°Ù
                                </button>
                            </div>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 10px;">
                            <div><strong>Ø³Ø±Ù…Ø§ÛŒÙ‡:</strong> $${analysis.amount}</div>
                            <div><strong>Ø¨Ø§Ø²Ù‡ Ø²Ù…Ø§Ù†ÛŒ:</strong> ${getTimeframeLabel(analysis.timeframe)}</div>
                            <div><strong>ØªÙˆØµÛŒÙ‡:</strong> ${analysis.result.decision}</div>
                            <div><strong>Ø§Ø­ØªÙ…Ø§Ù„:</strong> ${analysis.result.probability}%</div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            listDiv.innerHTML = html;
        }

        // Ø­Ø°Ù ØªØ­Ù„ÛŒÙ„
        function deleteAnalysis(id) {
            const savedAnalyses = JSON.parse(localStorage.getItem('mousaSavedAnalyses') || '[]');
            const filtered = savedAnalyses.filter(a => a.id !== id);
            localStorage.setItem('mousaSavedAnalyses', JSON.stringify(filtered));
            loadSavedAnalyses();
            showNotification('ØªØ­Ù„ÛŒÙ„ Ø­Ø°Ù Ø´Ø¯');
        }

        // Ø­Ø°Ù Ù‡Ù…Ù‡ ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§
        function clearAllAnalyses() {
            if (confirm('Ø¢ÛŒØ§ Ø§Ø² Ø­Ø°Ù ØªÙ…Ø§Ù… ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡ Ø´Ø¯Ù‡ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø¯Ø§Ø±ÛŒØ¯ØŸ')) {
                localStorage.removeItem('mousaSavedAnalyses');
                loadSavedAnalyses();
                showNotification('ØªÙ…Ø§Ù… ØªØ­Ù„ÛŒÙ„â€ŒÙ‡Ø§ Ø­Ø°Ù Ø´Ø¯Ù†Ø¯');
            }
        }

        // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ù…Ø­Ø§Ø³Ø¨Ù‡ Ø®ÙˆØ¯Ú©Ø§Ø±
        document.getElementById('calcAmount').addEventListener('input', calculateTrade);
        document.getElementById('calcLeverage').addEventListener('input', calculateTrade);
        document.getElementById('calcPriceChange').addEventListener('input', calculateTrade);
        document.getElementById('calcPosition').addEventListener('change', calculateTrade);

        // ØªØ§Ø¨Ø¹ toggleSidebar
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }
    </script>
</body>
</html>
